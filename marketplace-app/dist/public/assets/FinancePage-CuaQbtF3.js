import{c as N,d as me,u as ue,g as ye,b as pe,r as h,a as f,j as e,S as Z,X as je,f as d}from"./index-B6hPo9fH.js";import{u}from"./useMutation-C_3TpXjp.js";import{L as be,W as fe}from"./Layout-BTVfT1Q4.js";import{C as c,a as o,b as z,c as C}from"./card-Cl1MO1GN.js";import{B as t}from"./button-DdYfvWb9.js";import{B as g}from"./badge-Dn4EaI7W.js";import{I as Ne}from"./input-vnQcFn7U.js";import{T as we,a as ke,b as T,c as S}from"./tabs-YN5y1_yR.js";import{D as A,d as U,a as D,b as R,c as $,e as q,f as L,g as E}from"./dialog-D_lwzFP4.js";import{T as W}from"./textarea-Cc28xWq-.js";import{L as ve}from"./label-B38SsxLd.js";import{T as Fe,a as ze,b as ee,c as y,d as Ce,e as p}from"./table-ClTGZG61.js";import{C as Te}from"./checkbox-BZSYmHI3.js";import{u as Se}from"./useTranslation-O3_Fa0eH.js";import{D as P}from"./dollar-sign-pMvEizJe.js";import{C as Ae}from"./clock-BbwHj01_.js";import{U as ae}from"./index-Dt-oTuiC.js";import{C as Ue}from"./credit-card-BZDy1eUY.js";import{C as se}from"./ThemeToggle-Cd9vwdUm.js";import{B as re}from"./ban-BNghf3i0.js";import{T as te}from"./triangle-alert-DGpOeCBb.js";import{S as ne}from"./search-BRMhtFmq.js";import{L as De}from"./lock-open-New0CUEt.js";import{F as Re}from"./flag-CuHtVT3T.js";import"./shield-DVigj7cn.js";import"./shopping-cart-DT7LSJeM.js";import"./index-D8nDhomm.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],qe=N("banknote",$e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],ie=N("circle-arrow-down",Le);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],j=N("circle-arrow-up",Ee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],_=N("history",We);function ya(){const{t:Pe}=Se(),{toast:n}=me(),i=ue(),M=ye(),[,le]=pe(),[x,de]=h.useState(""),[_e,Me]=h.useState(null),[w,B]=h.useState(""),[k,K]=h.useState(""),[v,O]=h.useState(""),[Q,I]=h.useState(!1);if(M?.role!=="finance_manager"&&M?.role!=="admin")return le("/"),null;const{data:F,isLoading:ce}=f({queryKey:["finance-pending-withdrawals"],queryFn:async()=>{const a=await d("/api/finance/withdrawals/pending");return a.ok?a.json():[]}}),{data:b,isLoading:Be}=f({queryKey:["finance-stats"],queryFn:async()=>{const a=await d("/api/finance/stats");return a.ok?a.json():null}}),{data:s,isLoading:oe,refetch:xe}=f({queryKey:["finance-search-user",x],queryFn:async()=>{if(!x.trim())return null;const a=await d(`/api/finance/user/search?username=${encodeURIComponent(x)}`);return a.ok?a.json():null},enabled:!1}),{data:m,isLoading:he}=f({queryKey:["finance-all-transactions"],queryFn:async()=>{const a=await d("/api/finance/transactions");return a.ok?a.json():[]}}),H=u({mutationFn:async({userId:a,reason:r,shouldFreeze:l})=>{const Y=await d(`/api/finance/users/${a}/flag`,{method:"POST",body:JSON.stringify({reason:r,shouldFreeze:l})});if(!Y.ok)throw new Error("Failed to flag user");return Y.json()},onSuccess:a=>{i.invalidateQueries({queryKey:["finance-search-user",x]}),i.invalidateQueries({queryKey:["finance-pending-withdrawals"]}),n({title:"User Flagged",description:a.frozen?"User has been flagged and account frozen":"User has been flagged for review"}),O(""),I(!1)},onError:()=>{n({variant:"destructive",title:"Error",description:"Failed to flag user"})}}),J=u({mutationFn:async a=>{const r=await d(`/api/finance/withdrawals/${a}/approve`,{method:"POST"});if(!r.ok){const l=await r.json();throw new Error(l.message||"Failed to approve withdrawal")}return r.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["finance-pending-withdrawals"]}),i.invalidateQueries({queryKey:["finance-stats"]}),n({title:"Withdrawal Approved",description:"The withdrawal has been processed"})},onError:a=>{n({variant:"destructive",title:"Error",description:a.message})}}),V=u({mutationFn:async({id:a,reason:r})=>{const l=await d(`/api/finance/withdrawals/${a}/reject`,{method:"POST",body:JSON.stringify({reason:r})});if(!l.ok)throw new Error("Failed to reject withdrawal");return l.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["finance-pending-withdrawals"]}),n({title:"Withdrawal Rejected",description:"The withdrawal has been rejected and funds returned"}),K("")},onError:()=>{n({variant:"destructive",title:"Error",description:"Failed to reject withdrawal"})}}),X=u({mutationFn:async({userId:a,reason:r})=>{const l=await d(`/api/admin/users/${a}/freeze`,{method:"POST",body:JSON.stringify({reason:r})});if(!l.ok)throw new Error("Failed to freeze user");return l.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["finance-search-user",x]}),i.invalidateQueries({queryKey:["finance-pending-withdrawals"]}),n({title:"User Frozen",description:"Account has been frozen"}),B("")},onError:()=>{n({variant:"destructive",title:"Error",description:"Failed to freeze user"})}}),G=u({mutationFn:async a=>{const r=await d(`/api/admin/users/${a}/unfreeze`,{method:"POST"});if(!r.ok)throw new Error("Failed to unfreeze user");return r.json()},onSuccess:()=>{i.invalidateQueries({queryKey:["finance-search-user",x]}),i.invalidateQueries({queryKey:["finance-pending-withdrawals"]}),n({title:"User Unfrozen",description:"Account has been unfrozen"})},onError:()=>{n({variant:"destructive",title:"Error",description:"Failed to unfreeze user"})}}),ge=a=>{a.preventDefault(),xe()};return e.jsx(be,{children:e.jsxs("div",{className:"space-y-6","data-testid":"finance-page",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(qe,{className:"h-8 w-8 text-emerald-500"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Finance Manager"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{className:"bg-gradient-to-br from-emerald-900/40 to-emerald-800/30 border-emerald-700",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P,{className:"h-10 w-10 text-emerald-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-300 text-sm",children:"Total Platform Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-white","data-testid":"total-balance",children:["$",b?.totalBalance||"0.00"]})]})]})})}),e.jsx(c,{className:"bg-gradient-to-br from-orange-900/40 to-orange-800/30 border-orange-700",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"h-10 w-10 text-orange-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-300 text-sm",children:"Pending Withdrawals"}),e.jsxs("p",{className:"text-2xl font-bold text-white","data-testid":"pending-withdrawals",children:["$",b?.pendingWithdrawals||"0.00"]})]})]})})}),e.jsx(c,{className:"bg-gradient-to-br from-blue-900/40 to-blue-800/30 border-blue-700",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:"h-10 w-10 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-300 text-sm",children:"Today's Withdrawals"}),e.jsxs("p",{className:"text-2xl font-bold text-white","data-testid":"today-withdrawals",children:["$",b?.todayWithdrawals||"0.00"]})]})]})})}),e.jsx(c,{className:"bg-gradient-to-br from-purple-900/40 to-purple-800/30 border-purple-700",children:e.jsx(o,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{className:"h-10 w-10 text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-300 text-sm",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-white","data-testid":"total-users",children:b?.totalUsers||0})]})]})})})]}),e.jsxs(we,{defaultValue:"withdrawals",className:"space-y-4",children:[e.jsxs(ke,{className:"bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 flex-wrap h-auto gap-1 p-1",children:[e.jsxs(T,{value:"withdrawals","data-testid":"tab-withdrawals",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Pending Withdrawals (",F?.length||0,")"]}),e.jsxs(T,{value:"transactions","data-testid":"tab-transactions",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"All Transactions"]}),e.jsxs(T,{value:"accounts","data-testid":"tab-accounts",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Account Lookup"]})]}),e.jsx(S,{value:"withdrawals",className:"space-y-4",children:ce?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(a=>e.jsx(Z,{className:"h-32 bg-gray-200 dark:bg-gray-800"},a))}):F?.length===0?e.jsx(c,{className:"bg-gray-100 dark:bg-gray-900/50 border-gray-300 dark:border-gray-800",children:e.jsxs(o,{className:"py-12 text-center",children:[e.jsx(se,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No pending withdrawals"})]})}):F?.map(a=>e.jsxs(c,{className:`border ${a.userFrozen||a.inDispute?"border-red-500 bg-red-900/10":"border-gray-300 dark:border-gray-800 bg-gray-100 dark:bg-gray-900/50"}`,"data-testid":`withdrawal-card-${a.id}`,children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-orange-500"}),"Withdrawal Request"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.userFrozen&&e.jsxs(g,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(re,{className:"h-3 w-3"}),"Account Frozen"]}),a.inDispute&&e.jsxs(g,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),"In Dispute"]}),e.jsx(g,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 dark:text-yellow-500 border-yellow-500",children:a.status})]})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Username"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:a.username||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Amount"}),e.jsxs("p",{className:"text-gray-900 dark:text-white font-bold text-lg",children:["$",parseFloat(a.amount).toFixed(2)," ",a.currency]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Wallet Address"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-mono text-xs truncate",children:a.walletAddress||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Network"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:a.network||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Requested"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:new Date(a.createdAt).toLocaleString()})]})]}),(a.userFrozen||a.inDispute)&&e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 rounded-lg",children:e.jsxs("p",{className:"text-red-700 dark:text-red-400 text-sm flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),a.userFrozen?"This user's account is frozen. Review before approving.":"This user has an active dispute. Review before approving."]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-300 dark:border-gray-800",children:[e.jsxs(t,{className:"bg-green-600 hover:bg-green-700",onClick:()=>J.mutate(a.id),disabled:J.isPending,"data-testid":`button-approve-withdrawal-${a.id}`,children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(A,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(t,{variant:"destructive","data-testid":`button-reject-withdrawal-${a.id}`,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Reject"]})}),e.jsxs(D,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(R,{children:[e.jsx($,{className:"text-gray-900 dark:text-white",children:"Reject Withdrawal"}),e.jsx(q,{className:"text-gray-600 dark:text-gray-400",children:"The funds will be returned to the user's wallet."})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(W,{value:k,onChange:r=>K(r.target.value),placeholder:"Reason for rejection...",className:"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700"})}),e.jsxs(L,{children:[e.jsx(E,{asChild:!0,children:e.jsx(t,{variant:"outline",children:"Cancel"})}),e.jsx(t,{variant:"destructive",onClick:()=>V.mutate({id:a.id,reason:k}),disabled:V.isPending||!k.trim(),children:"Confirm Rejection"})]})]})]})]})]})]},a.id))}),e.jsx(S,{value:"transactions",className:"space-y-4",children:e.jsxs(c,{className:"bg-gray-100 dark:bg-gray-900/50 border-gray-300 dark:border-gray-800",children:[e.jsx(z,{children:e.jsxs(C,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"All Platform Transactions"]})}),e.jsx(o,{children:he?e.jsx(Z,{className:"h-64 bg-gray-200 dark:bg-gray-800"}):m&&m.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs(Fe,{children:[e.jsx(ze,{children:e.jsxs(ee,{className:"border-gray-300 dark:border-gray-700",children:[e.jsx(y,{className:"text-gray-600 dark:text-gray-400",children:"Type"}),e.jsx(y,{className:"text-gray-600 dark:text-gray-400",children:"Amount"}),e.jsx(y,{className:"text-gray-600 dark:text-gray-400",children:"Status"}),e.jsx(y,{className:"text-gray-600 dark:text-gray-400",children:"Description"}),e.jsx(y,{className:"text-gray-600 dark:text-gray-400",children:"Date"})]})}),e.jsx(Ce,{children:m.slice(0,100).map(a=>e.jsxs(ee,{className:"border-gray-200 dark:border-gray-700","data-testid":`transaction-row-${a.id}`,children:[e.jsx(p,{className:"text-gray-900 dark:text-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.type==="deposit"?e.jsx(ie,{className:"h-4 w-4 text-green-500"}):a.type==="withdraw"||a.type==="withdrawal"?e.jsx(j,{className:"h-4 w-4 text-red-500"}):e.jsx(P,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"capitalize",children:a.type.replace("_"," ")})]})}),e.jsxs(p,{className:`font-bold ${a.type==="deposit"||a.type==="escrow_release"||a.type==="refund"?"text-green-500":"text-red-500"}`,children:[a.type==="deposit"||a.type==="escrow_release"||a.type==="refund"?"+":"-","$",parseFloat(a.amount).toFixed(2)]}),e.jsx(p,{children:e.jsx(g,{variant:a.status==="completed"?"default":a.status==="pending"?"secondary":"outline",children:a.status||"completed"})}),e.jsx(p,{className:"text-gray-600 dark:text-gray-400 max-w-xs truncate",children:a.description||"-"}),e.jsx(p,{className:"text-gray-600 dark:text-gray-400",children:new Date(a.createdAt).toLocaleString()})]},a.id))})]}),m.length>100&&e.jsxs("p",{className:"text-center text-gray-500 dark:text-gray-400 mt-4 text-sm",children:["Showing 100 of ",m.length," transactions"]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No transactions found"})]})})]})}),e.jsx(S,{value:"accounts",className:"space-y-4",children:e.jsxs(c,{className:"bg-gray-100 dark:bg-gray-900/50 border-gray-300 dark:border-gray-800",children:[e.jsx(z,{children:e.jsxs(C,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Account Lookup"]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("form",{onSubmit:ge,className:"flex gap-2",children:[e.jsx(Ne,{value:x,onChange:a=>de(a.target.value),placeholder:"Enter username to search...",className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700","data-testid":"input-search-username"}),e.jsxs(t,{type:"submit",disabled:oe,"data-testid":"button-search-user",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Search"]})]}),s&&e.jsx(c,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700",children:e.jsxs(o,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ae,{className:"h-10 w-10 text-gray-500 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:s.username}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.email})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:s.isFrozen?"destructive":"default",children:s.isFrozen?"Frozen":"Active"}),e.jsx(g,{variant:"outline",children:s.role})]})]}),s.wallet&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Available Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:["$",parseFloat(s.wallet.availableBalance).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"In Escrow"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:["$",parseFloat(s.wallet.escrowBalance).toFixed(2)]})]})]}),s.isFrozen&&s.frozenReason&&e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 rounded-lg",children:e.jsxs("p",{className:"text-red-700 dark:text-red-400 text-sm",children:[e.jsx("strong",{children:"Frozen Reason:"})," ",s.frozenReason]})}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:s.isFrozen?e.jsxs(t,{className:"bg-green-600 hover:bg-green-700",onClick:()=>G.mutate(s.id),disabled:G.isPending,"data-testid":"button-unfreeze-user",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Unfreeze Account"]}):e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(t,{variant:"destructive","data-testid":"button-freeze-user",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Freeze Account"]})}),e.jsxs(D,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(R,{children:[e.jsx($,{className:"text-gray-900 dark:text-white",children:"Freeze Account"}),e.jsx(q,{className:"text-gray-600 dark:text-gray-400",children:"This will prevent the user from making any transactions."})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(W,{value:w,onChange:a=>B(a.target.value),placeholder:"Reason for freezing...",className:"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700"})}),e.jsxs(L,{children:[e.jsx(E,{asChild:!0,children:e.jsx(t,{variant:"outline",children:"Cancel"})}),e.jsx(t,{variant:"destructive",onClick:()=>X.mutate({userId:s.id,reason:w}),disabled:X.isPending||!w.trim(),children:"Confirm Freeze"})]})]})]}),e.jsxs(A,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(t,{variant:"outline",className:"border-yellow-500 text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-900/20","data-testid":"button-flag-user",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Flag Suspicious"]})}),e.jsxs(D,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(R,{children:[e.jsx($,{className:"text-gray-900 dark:text-white",children:"Flag Suspicious Account"}),e.jsx(q,{className:"text-gray-600 dark:text-gray-400",children:"Report this account for suspicious activity. Optionally freeze the account."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ve,{className:"text-gray-700 dark:text-gray-300",children:"Reason for flagging"}),e.jsx(W,{value:v,onChange:a=>O(a.target.value),placeholder:"Describe the suspicious activity...",className:"bg-gray-50 dark:bg-gray-800 border-gray-300 dark:border-gray-700"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:"freeze-on-flag",checked:Q,onCheckedChange:a=>I(a===!0)}),e.jsx("label",{htmlFor:"freeze-on-flag",className:"text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:"Also freeze this account"})]})]}),e.jsxs(L,{children:[e.jsx(E,{asChild:!0,children:e.jsx(t,{variant:"outline",children:"Cancel"})}),e.jsx(t,{className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>H.mutate({userId:s.id,reason:v,shouldFreeze:Q}),disabled:H.isPending||!v.trim(),children:"Submit Flag"})]})]})]})]})}),s.transactions&&s.transactions.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Transaction History"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:s.transactions.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.type==="deposit"?e.jsx(ie,{className:"h-5 w-5 text-green-500"}):a.type==="withdraw"?e.jsx(j,{className:"h-5 w-5 text-red-500"}):e.jsx(P,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-900 dark:text-white font-medium capitalize",children:a.type.replace("_"," ")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:a.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-bold ${a.type==="deposit"||a.type==="escrow_release"||a.type==="refund"?"text-green-500":"text-red-500"}`,children:[a.type==="deposit"||a.type==="escrow_release"||a.type==="refund"?"+":"-","$",parseFloat(a.amount).toFixed(2)]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:new Date(a.createdAt).toLocaleDateString()})]})]},a.id))})]})]})})]})]})})]})]})})}export{ya as default};
