import{c as ue,r as n,R as Fs,n as Us,o as es,j as e,p as Ts,P as ss,q as Ds,e as Be,d as ts,u as as,g as Ms,a as U,S as T,X as Rs,f as g}from"./index-B6hPo9fH.js";import{u as E}from"./useMutation-C_3TpXjp.js";import{L as ze,W as we,S as Ve}from"./Layout-BTVfT1Q4.js";import{C as b,a as N,b as A,c as $}from"./card-Cl1MO1GN.js";import{B as d}from"./button-DdYfvWb9.js";import{B as v}from"./badge-Dn4EaI7W.js";import{T as As,a as $s,b as P,c as q}from"./tabs-YN5y1_yR.js";import{D as B,d as ie,a as z,b as V,c as O,e as de,f as _,g as se}from"./dialog-D_lwzFP4.js";import{T as Y}from"./textarea-Cc28xWq-.js";import{S as Oe,a as _e,b as Ye,c as He,d as y}from"./select-_UnfLIee.js";import{L as k}from"./label-B38SsxLd.js";import{u as Ps}from"./index-D8nDhomm.js";import{I as qs}from"./input-vnQcFn7U.js";import{T as oe,a as ce,b as W,c,d as me,e as m}from"./table-ClTGZG61.js";import{u as Ws}from"./useTranslation-O3_Fa0eH.js";import{T as ye}from"./triangle-alert-DGpOeCBb.js";import{S as Is}from"./shield-DVigj7cn.js";import{C as Ks}from"./chart-column-CdgtT9kY.js";import{C as Qe}from"./credit-card-BZDy1eUY.js";import{F as Je}from"./file-text-CULx7Jr7.js";import{S as Xe,C as H,a as Ls}from"./ThemeToggle-Cd9vwdUm.js";import{A as Ce}from"./arrow-down-left-H1CA7R40.js";import{U as te}from"./index-Dt-oTuiC.js";import{D as Bs}from"./dollar-sign-pMvEizJe.js";import{B as zs}from"./ban-BNghf3i0.js";import{T as Vs}from"./trash-2-DycntUct.js";import{S as Ge}from"./star-CUTTDGaz.js";import{I as Se}from"./image-IeDDDsTa.js";import{L as Ee}from"./lock-open-New0CUEt.js";import{L as Fe}from"./lock-67rVn5Zl.js";import{C as Ze}from"./clock-BbwHj01_.js";import{M as Os}from"./message-square-CcAE1XrF.js";import{C as _s}from"./chevron-left-DsaiS75a.js";import"./shopping-cart-DT7LSJeM.js";import"./index-BdQq_4o_.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Hs=ue("power",Ys);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Js=ue("refresh-ccw",Qs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ke=ue("users",Xs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ae=ue("zoom-in",Gs);function Zs(l,r,{checkForDefaultPrevented:a=!0}={}){return function(x){if(l?.(x),a===!1||!x.defaultPrevented)return r?.(x)}}var et=Fs[" useInsertionEffect ".trim().toString()]||Us;function st({prop:l,defaultProp:r,onChange:a=()=>{},caller:f}){const[x,j,i]=tt({defaultProp:r,onChange:a}),u=l!==void 0,C=u?l:x;{const p=n.useRef(l!==void 0);n.useEffect(()=>{const S=p.current;S!==u&&console.warn(`${f} is changing from ${S?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=u},[u,f])}const D=n.useCallback(p=>{if(u){const S=at(p)?p(l):p;S!==l&&i.current?.(S)}else j(p)},[u,l,j,i]);return[C,D]}function tt({defaultProp:l,onChange:r}){const[a,f]=n.useState(l),x=n.useRef(a),j=n.useRef(r);return et(()=>{j.current=r},[r]),n.useEffect(()=>{x.current!==a&&(j.current?.(a),x.current=a)},[a,x]),[a,f,j]}function at(l){return typeof l=="function"}var xe="Switch",[rt]=Ts(xe),[nt,lt]=rt(xe),rs=n.forwardRef((l,r)=>{const{__scopeSwitch:a,name:f,checked:x,defaultChecked:j,required:i,disabled:u,value:C="on",onCheckedChange:D,form:p,...S}=l,[h,M]=n.useState(null),I=es(r,K=>M(K)),F=n.useRef(!1),he=h?p||!!h.closest("form"):!0,[Q,Ue]=st({prop:x,defaultProp:j??!1,onChange:D,caller:xe});return e.jsxs(nt,{scope:a,checked:Q,disabled:u,children:[e.jsx(ss.button,{type:"button",role:"switch","aria-checked":Q,"aria-required":i,"data-state":ds(Q),"data-disabled":u?"":void 0,disabled:u,value:C,...S,ref:I,onClick:Zs(l.onClick,K=>{Ue(Te=>!Te),he&&(F.current=K.isPropagationStopped(),F.current||K.stopPropagation())})}),he&&e.jsx(is,{control:h,bubbles:!F.current,name:f,value:C,checked:Q,required:i,disabled:u,form:p,style:{transform:"translateX(-100%)"}})]})});rs.displayName=xe;var ns="SwitchThumb",ls=n.forwardRef((l,r)=>{const{__scopeSwitch:a,...f}=l,x=lt(ns,a);return e.jsx(ss.span,{"data-state":ds(x.checked),"data-disabled":x.disabled?"":void 0,...f,ref:r})});ls.displayName=ns;var it="SwitchBubbleInput",is=n.forwardRef(({__scopeSwitch:l,control:r,checked:a,bubbles:f=!0,...x},j)=>{const i=n.useRef(null),u=es(i,j),C=Ps(a),D=Ds(r);return n.useEffect(()=>{const p=i.current;if(!p)return;const S=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(S,"checked").set;if(C!==a&&M){const I=new Event("click",{bubbles:f});M.call(p,a),p.dispatchEvent(I)}},[C,a,f]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...x,tabIndex:-1,ref:u,style:{...x.style,...D,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});is.displayName=it;function ds(l){return l?"checked":"unchecked"}var os=rs,dt=ls;const cs=n.forwardRef(({className:l,...r},a)=>e.jsx(os,{className:Be("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...r,ref:a,children:e.jsx(dt,{className:Be("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));cs.displayName=os.displayName;function ot(){const{toast:l}=ts(),r=as(),{data:a,isLoading:f}=U({queryKey:["admin-wallet-dashboard"],queryFn:async()=>{const i=await g("/api/admin/blockchain/dashboard");if(!i.ok)throw new Error("Failed to fetch wallet dashboard");return i.json()},refetchInterval:3e4}),x=E({mutationFn:async()=>{const i=await g("/api/admin/blockchain/unlock-wallet",{method:"POST"});if(!i.ok){const u=await i.json();throw new Error(u.message||"Failed to unlock wallet")}return i.json()},onSuccess:()=>{l({title:"Master wallet unlocked",description:"Withdrawals can now be processed"}),r.invalidateQueries({queryKey:["admin-wallet-dashboard"]})},onError:i=>{l({title:"Failed to unlock wallet",description:i.message,variant:"destructive"})}}),j=E({mutationFn:async()=>{const i=await g("/api/admin/blockchain/lock-wallet",{method:"POST"});if(!i.ok){const u=await i.json();throw new Error(u.message||"Failed to lock wallet")}return i.json()},onSuccess:()=>{l({title:"Master wallet locked",description:"Withdrawals are now disabled"}),r.invalidateQueries({queryKey:["admin-wallet-dashboard"]})},onError:i=>{l({title:"Failed to lock wallet",description:i.message,variant:"destructive"})}});return f?e.jsx(T,{className:"h-32"}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-4 rounded-lg border ${a?.isWalletUnlocked?"bg-green-950/30 border-green-700":"bg-destructive/10 border-destructive"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a?.isWalletUnlocked?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(Fe,{className:"h-6 w-6 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold ${a?.isWalletUnlocked?"text-green-600":"text-destructive"}`,children:a?.isWalletUnlocked?"Wallet UNLOCKED":"Wallet LOCKED"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:a?.isWalletUnlocked?"Withdrawals can be processed":"Withdrawals are disabled until wallet is unlocked"})]})]}),a?.isWalletUnlocked?e.jsxs(d,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>j.mutate(),disabled:j.isPending,"data-testid":"button-lock-wallet",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Lock Wallet"]}):e.jsxs(d,{className:"bg-green-600 hover:bg-green-700",onClick:()=>x.mutate(),disabled:x.isPending,"data-testid":"button-unlock-wallet",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Unlock Wallet"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-card rounded-lg border border-border",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Master Wallet Address"}),e.jsx("p",{className:"text-foreground font-mono text-xs break-all",children:a?.masterWalletAddress||"Not configured"})]}),e.jsxs("div",{className:"p-4 bg-card rounded-lg border border-border",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"USDT Balance"}),e.jsxs("p",{className:"text-foreground font-bold",children:[a?.masterWalletUsdtBalance||"0.00"," USDT"]})]}),e.jsxs("div",{className:"p-4 bg-card rounded-lg border border-border",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"BNB Balance (Gas)"}),e.jsxs("p",{className:"text-foreground font-bold",children:[a?.masterWalletBnbBalance||"0.00"," BNB"]})]})]})]})}function Ot(){const{t:l}=Ws(),{toast:r}=ts(),a=as(),f=Ms(),[x,j]=n.useState(null),[i,u]=n.useState(""),[C,D]=n.useState(""),[p,S]=n.useState("tier1"),[h,M]=n.useState(null),[I,F]=n.useState(0),[he,Q]=n.useState(""),[Ue,K]=n.useState(null),[Te,De]=n.useState(null),[ge,Me]=n.useState(""),[J,je]=n.useState(null),[X,Re]=n.useState(""),[re,ms]=n.useState(""),[Ae,pe]=n.useState(!1),fe=s=>{const t=[];return s.idDocumentUrl&&t.push({url:s.idDocumentUrl,label:"ID Document"}),s.idFrontUrl&&t.push({url:s.idFrontUrl,label:"ID Front"}),s.idBackUrl&&t.push({url:s.idBackUrl,label:"ID Back"}),s.selfieUrl&&t.push({url:s.selfieUrl,label:"Selfie"}),t},G=(s,t=0)=>{M(s),F(t)},be=()=>{M(null),F(0)},us=()=>{if(h){const s=fe(h);s.length>0&&F(t=>(t+1)%s.length)}},xs=()=>{if(h){const s=fe(h);s.length>0&&F(t=>(t-1+s.length)%s.length)}};if(f?.role!=="admin")return e.jsx(ze,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ye,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access this page."})]})})});const{data:Ne,isLoading:hs}=U({queryKey:["admin-pending-kyc"],queryFn:async()=>{const s=await g("/api/admin/kyc/pending");if(!s.ok)throw new Error("Failed to fetch pending KYC");return s.json()}}),{data:ve,isLoading:gs}=U({queryKey:["admin-pending-vendors"],queryFn:async()=>{const s=await g("/api/admin/vendors/pending");if(!s.ok)throw new Error("Failed to fetch pending vendors");return s.json()}}),{data:Z,isLoading:js}=U({queryKey:["admin-stats"],queryFn:async()=>{const s=await g("/api/admin/stats");if(!s.ok)throw new Error("Failed to fetch stats");return s.json()}}),{data:$e,isLoading:ps}=U({queryKey:["admin-users"],queryFn:async()=>{const s=await g("/api/admin/users");if(!s.ok)throw new Error("Failed to fetch users");return s.json()}}),{data:Pe,isLoading:fs}=U({queryKey:["admin-transactions"],queryFn:async()=>{const s=await g("/api/admin/transactions");if(!s.ok)throw new Error("Failed to fetch transactions");return s.json()}}),{data:qe,isLoading:bs}=U({queryKey:["admin-wallets"],queryFn:async()=>{const s=await g("/api/admin/wallets");if(!s.ok)throw new Error("Failed to fetch wallets");return(await s.json()).wallets||[]}}),{data:o,isLoading:Ns}=U({queryKey:["admin-maintenance"],queryFn:async()=>{const s=await g("/api/admin/maintenance");if(!s.ok)throw new Error("Failed to fetch maintenance settings");return s.json()}}),{data:ne,isLoading:vs}=U({queryKey:["admin-pending-withdrawals"],queryFn:async()=>{const s=await g("/api/admin/withdrawals");if(!s.ok)throw new Error("Failed to fetch withdrawals");return s.json()}}),L=E({mutationFn:async s=>{const t=await g("/api/admin/maintenance",{method:"PATCH",body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to update maintenance settings");return t.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-maintenance"]}),r({title:"Settings Updated",description:"Maintenance settings have been saved"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to update maintenance settings"})}}),ws=E({mutationFn:async({userId:s,role:t})=>{const w=await g(`/api/admin/users/${s}/role`,{method:"PATCH",body:JSON.stringify({role:t})});if(!w.ok)throw new Error("Failed to change role");return w.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-users"]}),r({title:"Role Updated",description:"User role has been changed"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to change user role"})}}),ys=E({mutationFn:async s=>{const t=await g(`/api/admin/users/${s}`,{method:"DELETE"});if(!t.ok)throw new Error("Failed to delete user");return t.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-users"]}),K(null),r({title:"User Deleted",description:"User has been removed from the platform"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to delete user"})}}),Cs=E({mutationFn:async({userId:s,reason:t})=>{const w=await g(`/api/admin/users/${s}/freeze`,{method:"POST",body:JSON.stringify({reason:t})});if(!w.ok)throw new Error("Failed to freeze user");return w.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-users"]}),De(null),Me(""),r({title:"User Frozen",description:"User account has been frozen"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to freeze user"})}}),Ss=E({mutationFn:async s=>{const t=await g(`/api/admin/users/${s}/unfreeze`,{method:"POST"});if(!t.ok)throw new Error("Failed to unfreeze user");return t.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-users"]}),r({title:"User Unfrozen",description:"User account has been unfrozen"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to unfreeze user"})}}),le=E({mutationFn:async({id:s,status:t,tier:w,adminNotes:ee,rejectionReason:Es})=>{const Le=await g(`/api/admin/kyc/${s}/review`,{method:"POST",body:JSON.stringify({status:t,tier:w,adminNotes:ee,rejectionReason:Es})});if(!Le.ok)throw new Error("Failed to review KYC");return Le.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-pending-kyc"]}),j(null),u(""),D(""),r({title:"KYC Reviewed",description:"The KYC application has been processed"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to process KYC review"})}}),We=E({mutationFn:async s=>{const t=await g(`/api/admin/kyc/${s}/star-verify`,{method:"POST"});if(!t.ok)throw new Error("Failed to toggle star verification");return t.json()},onSuccess:s=>{a.invalidateQueries({queryKey:["admin-pending-kyc"]}),r({title:s.isStarVerified?"Star Verified":"Star Removed",description:s.isStarVerified?"User is now star verified":"Star verification has been removed"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to toggle star verification"})}}),Ie=E({mutationFn:async s=>{const t=await g(`/api/admin/vendors/${s}/approve`,{method:"POST"});if(!t.ok)throw new Error("Failed to approve vendor");return t.json()},onSuccess:()=>{a.invalidateQueries({queryKey:["admin-pending-vendors"]}),r({title:"Vendor Approved",description:"The vendor has been approved"})},onError:()=>{r({variant:"destructive",title:"Error",description:"Failed to approve vendor"})}}),R=s=>{const t=s.idFrontUrl&&s.idBackUrl&&s.selfieUrl,w=s.idDocumentUrl&&s.selfieUrl;return t||w},Ke=s=>{if(!R(s)){r({variant:"destructive",title:"Cannot Approve",description:"User must upload required documents (ID document + selfie) before approval"});return}le.mutate({id:s.id,status:"approved",tier:p,adminNotes:i})},ks=s=>{if(!C.trim()){r({variant:"destructive",title:"Error",description:"Please provide a rejection reason"});return}le.mutate({id:s.id,status:"rejected",tier:s.tier,adminNotes:i,rejectionReason:C})};return e.jsx(ze,{children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 px-2 sm:px-4","data-testid":"admin-page",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(Is,{className:"h-6 sm:h-8 w-6 sm:w-8 text-primary flex-shrink-0"}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground truncate",children:"Admin Dashboard"})]}),e.jsxs(As,{defaultValue:"stats",className:"space-y-4",children:[e.jsxs($s,{className:"flex-wrap h-auto gap-1 p-1",children:[e.jsxs(P,{value:"stats","data-testid":"tab-stats",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2"}),"Platform Stats"]}),e.jsxs(P,{value:"users","data-testid":"tab-users",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Users (",$e?.length||0,")"]}),e.jsxs(P,{value:"transactions","data-testid":"tab-transactions",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Transactions"]}),e.jsxs(P,{value:"wallets","data-testid":"tab-wallets",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Wallets"]}),e.jsxs(P,{value:"kyc","data-testid":"tab-kyc",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"KYC (",Ne?.length||0,")"]}),e.jsxs(P,{value:"vendors","data-testid":"tab-vendors",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Vendors (",ve?.length||0,")"]}),e.jsxs(P,{value:"withdrawals","data-testid":"tab-withdrawals",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Withdrawals (",ne?.filter(s=>s.status==="pending").length||0,")"]}),e.jsxs(P,{value:"maintenance","data-testid":"tab-maintenance",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Maintenance"]})]}),e.jsx(q,{value:"stats",className:"space-y-4",children:js?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[1,2,3,4,5].map(s=>e.jsx(T,{className:"h-32"},s))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(b,{className:"bg-primary/5 border-primary/20",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ke,{className:"h-10 w-10 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-foreground","data-testid":"stat-total-users",children:Z?.totalUsers||0})]})]})})}),e.jsx(b,{className:"bg-green-50/10 border-green-200/20 dark:bg-green-950/30 dark:border-green-800",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-10 w-10 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Today"}),e.jsx("p",{className:"text-3xl font-bold text-foreground","data-testid":"stat-today-users",children:Z?.todayUsers||0})]})]})})}),e.jsx(b,{className:"bg-purple-50/10 border-purple-200/20 dark:bg-purple-950/30 dark:border-purple-800",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-10 w-10 text-purple-600 dark:text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"This Week"}),e.jsx("p",{className:"text-3xl font-bold text-foreground","data-testid":"stat-week-users",children:Z?.weekUsers||0})]})]})})}),e.jsx(b,{className:"bg-orange-50/10 border-orange-200/20 dark:bg-orange-950/30 dark:border-orange-800",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-10 w-10 text-orange-600 dark:text-orange-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"This Month"}),e.jsx("p",{className:"text-3xl font-bold text-foreground","data-testid":"stat-month-users",children:Z?.monthUsers||0})]})]})})}),e.jsx(b,{className:"bg-cyan-50/10 border-cyan-200/20 dark:bg-cyan-950/30 dark:border-cyan-800",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Bs,{className:"h-10 w-10 text-cyan-600 dark:text-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"Total Balance"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground","data-testid":"stat-total-balance",children:["$",Z?.totalBalance||"0.00"]})]})]})})})]})}),e.jsx(q,{value:"users",className:"space-y-4",children:e.jsxs(b,{children:[e.jsx(A,{children:e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),"User Management"]})}),e.jsx(N,{children:ps?e.jsx(T,{className:"h-64"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(W,{children:[e.jsx(c,{className:"text-muted-foreground",children:"Username"}),e.jsx(c,{className:"text-muted-foreground",children:"Email"}),e.jsx(c,{className:"text-muted-foreground",children:"Role"}),e.jsx(c,{className:"text-muted-foreground",children:"Status"}),e.jsx(c,{className:"text-muted-foreground",children:"Joined"}),e.jsx(c,{className:"text-muted-foreground",children:"Actions"})]})}),e.jsx(me,{children:$e?.map(s=>e.jsxs(W,{"data-testid":`user-row-${s.id}`,children:[e.jsx(m,{className:"text-foreground font-medium",children:s.username}),e.jsx(m,{className:"text-muted-foreground",children:s.email}),e.jsx(m,{children:e.jsxs(Oe,{value:s.role,onValueChange:t=>{if(s.role==="admin"){r({variant:"destructive",title:"Error",description:"Admin accounts cannot be demoted or changed"});return}ws.mutate({userId:s.id,role:t})},disabled:s.role==="admin",children:[e.jsx(_e,{className:`w-32 ${s.role==="admin"?"bg-muted border-border cursor-not-allowed opacity-70":"bg-card border-border"}`,children:e.jsx(Ye,{})}),e.jsxs(He,{children:[s.role==="customer"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{value:"customer",children:"Customer"}),e.jsx(y,{value:"vendor",children:"Vendor"})]}),s.role==="vendor"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{value:"customer",children:"Customer"}),e.jsx(y,{value:"vendor",children:"Vendor"})]}),s.role!=="customer"&&s.role!=="vendor"&&s.role!=="admin"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{value:"customer",children:"Customer"}),e.jsx(y,{value:"vendor",children:"Vendor"}),e.jsx(y,{value:"support",children:"Support"}),e.jsx(y,{value:"finance_manager",children:"Finance"}),e.jsx(y,{value:"dispute_admin",children:"Dispute Admin"})]}),s.role==="admin"&&e.jsx(y,{value:"admin",disabled:!0,children:"Admin (Cannot Change)"})]})]})}),e.jsx(m,{children:s.isFrozen?e.jsx(v,{variant:"destructive",children:"Frozen"}):e.jsx(v,{className:"bg-green-600",children:"Active"})}),e.jsx(m,{className:"text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-2",children:[s.isFrozen?e.jsx(d,{size:"sm",variant:"outline",className:"border-green-600 text-green-400 hover:bg-green-600/20",onClick:()=>Ss.mutate(s.id),"data-testid":`button-unfreeze-${s.id}`,children:e.jsx(Js,{className:"h-4 w-4"})}):e.jsxs(B,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"outline",className:"border-yellow-600 text-yellow-400 hover:bg-yellow-600/20",onClick:()=>De(s),"data-testid":`button-freeze-${s.id}`,children:e.jsx(zs,{className:"h-4 w-4"})})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsxs(O,{className:"text-foreground",children:["Freeze User: ",s.username]}),e.jsx(de,{className:"text-muted-foreground",children:"This will prevent the user from logging in or performing any actions."})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-muted-foreground",children:"Reason for freezing"}),e.jsx(Y,{value:ge,onChange:t=>Me(t.target.value),placeholder:"Enter reason..."})]})}),e.jsxs(_,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"outline",children:"Cancel"})}),e.jsx(d,{variant:"destructive",onClick:()=>Cs.mutate({userId:s.id,reason:ge}),disabled:!ge.trim(),children:"Freeze User"})]})]})]}),e.jsxs(B,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(d,{size:"sm",variant:"destructive",onClick:()=>K(s),"data-testid":`button-delete-${s.id}`,children:e.jsx(Vs,{className:"h-4 w-4"})})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsxs(O,{className:"text-foreground",children:["Delete User: ",s.username]}),e.jsx(de,{className:"text-muted-foreground",children:"This action cannot be undone. The user and all associated data will be permanently deleted."})]}),e.jsxs(_,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"outline",children:"Cancel"})}),e.jsx(d,{variant:"destructive",onClick:()=>ys.mutate(s.id),children:"Delete User"})]})]})]})]})})]},s.id))})]})})})]})}),e.jsx(q,{value:"transactions",className:"space-y-4",children:e.jsxs(b,{children:[e.jsx(A,{children:e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"All Transactions"]})}),e.jsx(N,{children:fs?e.jsx(T,{className:"h-64"}):Pe?.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No transactions found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(W,{children:[e.jsx(c,{className:"text-muted-foreground",children:"ID"}),e.jsx(c,{className:"text-muted-foreground",children:"Type"}),e.jsx(c,{className:"text-muted-foreground",children:"Amount"}),e.jsx(c,{className:"text-muted-foreground",children:"Status"}),e.jsx(c,{className:"text-muted-foreground",children:"Description"}),e.jsx(c,{className:"text-muted-foreground",children:"Date"})]})}),e.jsx(me,{children:Pe?.slice(0,50).map(s=>e.jsxs(W,{"data-testid":`tx-row-${s.id}`,children:[e.jsxs(m,{className:"text-muted-foreground font-mono text-xs",children:[s.id.slice(0,8),"..."]}),e.jsx(m,{children:e.jsx(v,{variant:"outline",className:s.type==="deposit"?"bg-green-500/10 text-green-400 border-green-500":s.type==="withdrawal"?"bg-red-500/10 text-red-400 border-red-500":"bg-blue-500/10 text-blue-400 border-blue-500",children:s.type})}),e.jsxs(m,{className:"text-foreground font-medium",children:["$",s.amount]}),e.jsx(m,{children:e.jsx(v,{className:s.status==="completed"?"bg-green-600":s.status==="pending"?"bg-yellow-600":"bg-red-600",children:s.status})}),e.jsx(m,{className:"text-muted-foreground max-w-xs truncate",children:s.description||"-"}),e.jsx(m,{className:"text-muted-foreground",children:new Date(s.createdAt).toLocaleString()})]},s.id))})]})})})]})}),e.jsx(q,{value:"wallets",className:"space-y-4",children:e.jsxs(b,{children:[e.jsx(A,{children:e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"All Wallets"]})}),e.jsx(N,{children:bs?e.jsx(T,{className:"h-64"}):qe?.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No wallets found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(W,{children:[e.jsx(c,{className:"text-muted-foreground",children:"Wallet ID"}),e.jsx(c,{className:"text-muted-foreground",children:"Currency"}),e.jsx(c,{className:"text-muted-foreground",children:"Available"}),e.jsx(c,{className:"text-muted-foreground",children:"In Escrow"}),e.jsx(c,{className:"text-muted-foreground",children:"Total"})]})}),e.jsx(me,{children:qe?.map(s=>e.jsxs(W,{"data-testid":`wallet-row-${s.id}`,children:[e.jsxs(m,{className:"text-muted-foreground font-mono text-xs",children:[s.id.slice(0,8),"..."]}),e.jsx(m,{children:e.jsx(v,{variant:"outline",className:"bg-blue-500/10 text-blue-400 border-blue-500",children:s.currency})}),e.jsxs(m,{className:"text-green-400 font-medium",children:["$",s.availableBalance]}),e.jsxs(m,{className:"text-yellow-400 font-medium",children:["$",s.escrowBalance]}),e.jsxs(m,{className:"text-foreground font-bold",children:["$",(parseFloat(s.availableBalance)+parseFloat(s.escrowBalance)).toFixed(2)]})]},s.id))})]})})})]})}),e.jsx(q,{value:"kyc",className:"space-y-4",children:hs?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(T,{className:"h-48"},s))}):Ne?.length===0?e.jsx(b,{children:e.jsxs(N,{className:"py-12 text-center",children:[e.jsx(H,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No pending KYC applications"})]})}):Ne?.map(s=>e.jsxs(b,{"data-testid":`kyc-card-${s.id}`,children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"KYC Application",s.isStarVerified&&e.jsx(Ge,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"outline",className:"bg-yellow-500/10 text-yellow-500 border-yellow-500",children:s.status}),e.jsx(v,{variant:"outline",children:s.tier})]})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"ID Type"}),e.jsx("p",{className:"text-foreground",children:s.idType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"ID Number"}),e.jsx("p",{className:"text-foreground",children:s.idNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Face Match Score"}),e.jsx("p",{className:"text-foreground",children:s.faceMatchScore?`${s.faceMatchScore}%`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Submitted"}),e.jsx("p",{className:"text-foreground",children:new Date(s.submittedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.idDocumentUrl&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),"ID Document"]}),e.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>G(s,0),children:[e.jsx("img",{src:s.idDocumentUrl,alt:"ID Document",className:"w-full h-40 object-cover rounded-lg border border-border transition-all group-hover:opacity-80","data-testid":`kyc-id-document-${s.id}`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/60 rounded-full p-3",children:e.jsx(ae,{className:"h-6 w-6 text-white"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),"ID Front"]}),s.idFrontUrl?e.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>G(s,s.idDocumentUrl?1:0),children:[e.jsx("img",{src:s.idFrontUrl,alt:"ID Front",className:"w-full h-40 object-cover rounded-lg border border-border transition-all group-hover:opacity-80","data-testid":`kyc-id-front-${s.id}`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/60 rounded-full p-3",children:e.jsx(ae,{className:"h-6 w-6 text-white"})})})]}):e.jsx("div",{className:"w-full h-40 bg-muted rounded-lg flex items-center justify-center border border-border",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Not uploaded"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),"ID Back"]}),s.idBackUrl?e.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>{let t=0;s.idDocumentUrl&&t++,s.idFrontUrl&&t++,G(s,t)},children:[e.jsx("img",{src:s.idBackUrl,alt:"ID Back",className:"w-full h-40 object-cover rounded-lg border border-border transition-all group-hover:opacity-80","data-testid":`kyc-id-back-${s.id}`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/60 rounded-full p-3",children:e.jsx(ae,{className:"h-6 w-6 text-white"})})})]}):e.jsx("div",{className:"w-full h-40 bg-muted rounded-lg flex items-center justify-center border border-border",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Not uploaded"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),"Selfie"]}),s.selfieUrl?e.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>{let t=0;s.idDocumentUrl&&t++,s.idFrontUrl&&t++,s.idBackUrl&&t++,G(s,t)},children:[e.jsx("img",{src:s.selfieUrl,alt:"Selfie",className:"w-full h-40 object-cover rounded-lg border border-border transition-all group-hover:opacity-80","data-testid":`kyc-selfie-${s.id}`}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/60 rounded-full p-3",children:e.jsx(ae,{className:"h-6 w-6 text-white"})})})]}):e.jsx("div",{className:"w-full h-40 bg-muted rounded-lg flex items-center justify-center border border-border",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Not uploaded"})})]})]}),e.jsxs(d,{variant:"outline",className:"w-full border-gray-700 mt-2",onClick:()=>G(s),disabled:!R(s),"data-testid":`button-view-documents-${s.id}`,children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"View All Documents"]}),!R(s)&&e.jsx("div",{className:"p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg mb-4",children:e.jsxs("p",{className:"text-yellow-400 text-sm flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Cannot approve: User must upload required documents (ID document + selfie)"]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-800",children:[e.jsxs(B,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(d,{className:R(s)?"bg-green-600 hover:bg-green-700":"bg-gray-600 cursor-not-allowed",onClick:()=>j(s),disabled:!R(s),"data-testid":`button-approve-kyc-${s.id}`,children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Approve"]})}),e.jsxs(z,{className:"bg-gray-900 border-gray-800",children:[e.jsx(V,{children:e.jsx(O,{className:"text-white",children:"Approve KYC"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-gray-400",children:"Verification Tier"}),e.jsxs(Oe,{value:p,onValueChange:S,children:[e.jsx(_e,{className:"bg-gray-800 border-gray-700",children:e.jsx(Ye,{})}),e.jsxs(He,{className:"bg-gray-800 border-gray-700",children:[e.jsx(y,{value:"tier1",children:"Tier 1"}),e.jsx(y,{value:"tier2",children:"Tier 2"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-gray-400",children:"Admin Notes (optional)"}),e.jsx(Y,{value:i,onChange:t=>u(t.target.value),placeholder:"Add any notes...",className:"bg-gray-800 border-gray-700"})]})]}),e.jsxs(_,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"outline",className:"border-gray-700",children:"Cancel"})}),e.jsx(d,{className:R(s)?"bg-green-600 hover:bg-green-700":"bg-gray-600 cursor-not-allowed",onClick:()=>Ke(s),disabled:le.isPending||!R(s),"data-testid":"button-confirm-approve",children:"Confirm Approval"})]})]})]}),e.jsxs(B,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(d,{variant:"destructive",onClick:()=>j(s),"data-testid":`button-reject-kyc-${s.id}`,children:[e.jsx(Rs,{className:"h-4 w-4 mr-2"}),"Reject"]})}),e.jsxs(z,{className:"bg-gray-900 border-gray-800",children:[e.jsx(V,{children:e.jsx(O,{className:"text-white",children:"Reject KYC"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-gray-400",children:"Rejection Reason (required)"}),e.jsx(Y,{value:C,onChange:t=>D(t.target.value),placeholder:"Explain why this KYC is being rejected...",className:"bg-gray-800 border-gray-700"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-gray-400",children:"Admin Notes (optional)"}),e.jsx(Y,{value:i,onChange:t=>u(t.target.value),placeholder:"Internal notes...",className:"bg-gray-800 border-gray-700"})]})]}),e.jsxs(_,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"outline",className:"border-gray-700",children:"Cancel"})}),e.jsx(d,{variant:"destructive",onClick:()=>ks(s),disabled:le.isPending,"data-testid":"button-confirm-reject",children:"Confirm Rejection"})]})]})]}),e.jsxs(d,{variant:"outline",className:`border-gray-700 ${s.isStarVerified?"text-yellow-500":""}`,onClick:()=>We.mutate(s.id),disabled:We.isPending,"data-testid":`button-star-verify-${s.id}`,children:[e.jsx(Ge,{className:`h-4 w-4 mr-2 ${s.isStarVerified?"fill-yellow-500":""}`}),s.isStarVerified?"Remove Star":"Star Verify"]})]})]})]},s.id))}),e.jsx(q,{value:"vendors",className:"space-y-4",children:gs?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(T,{className:"h-32"},s))}):ve?.length===0?e.jsx(b,{children:e.jsxs(N,{className:"py-12 text-center",children:[e.jsx(H,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No pending vendor applications"})]})}):ve?.map(s=>e.jsxs(b,{"data-testid":`vendor-card-${s.id}`,children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),s.businessName||"Unnamed Vendor"]}),e.jsx(v,{variant:"outline",className:"bg-yellow-500/10 text-yellow-500 border-yellow-500",children:"Pending Approval"})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Country"}),e.jsx("p",{className:"text-foreground",children:s.country})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Applied"}),e.jsx("p",{className:"text-foreground",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"md:col-span-1 col-span-2",children:[e.jsx("p",{className:"text-muted-foreground",children:"Bio"}),e.jsx("p",{className:"text-foreground",children:s.bio||"No bio provided"})]})]}),e.jsx("div",{className:"flex gap-2 pt-4 border-t border-border",children:e.jsxs(d,{className:"bg-green-600 hover:bg-green-700",onClick:()=>Ie.mutate(s.id),disabled:Ie.isPending,"data-testid":`button-approve-vendor-${s.id}`,children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Approve Vendor"]})})]})]},s.id))}),e.jsx(q,{value:"withdrawals",className:"space-y-4",children:e.jsxs(b,{children:[e.jsx(A,{children:e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"Pending Withdrawals"]})}),e.jsx(N,{children:vs?e.jsx(T,{className:"h-64"}):!ne||ne.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ce,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No withdrawal requests"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(W,{children:[e.jsx(c,{className:"text-muted-foreground",children:"Username"}),e.jsx(c,{className:"text-muted-foreground",children:"Amount"}),e.jsx(c,{className:"text-muted-foreground",children:"Currency"}),e.jsx(c,{className:"text-muted-foreground",children:"Wallet Address"}),e.jsx(c,{className:"text-muted-foreground",children:"Status"}),e.jsx(c,{className:"text-muted-foreground",children:"Requested"}),e.jsx(c,{className:"text-muted-foreground",children:"Actions"})]})}),e.jsx(me,{children:ne.map(s=>e.jsxs(W,{"data-testid":`withdrawal-row-${s.id}`,children:[e.jsx(m,{className:"text-foreground font-medium",children:s.username||s.userId}),e.jsx(m,{className:"text-foreground font-bold",children:s.amount}),e.jsx(m,{className:"text-muted-foreground",children:s.currency}),e.jsx(m,{className:"text-muted-foreground font-mono text-xs break-all max-w-xs",children:s.walletAddress}),e.jsx(m,{children:e.jsx(v,{className:s.status==="pending"?"bg-yellow-600":s.status==="approved"?"bg-green-600":"bg-red-600",children:s.status})}),e.jsx(m,{className:"text-muted-foreground text-sm",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(m,{children:s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-xs","data-testid":`button-approve-withdrawal-${s.id}`,children:"Approve"}),e.jsx(d,{size:"sm",variant:"destructive",className:"text-xs","data-testid":`button-reject-withdrawal-${s.id}`,children:"Reject"})]})})]},s.id))})]})})})]})}),e.jsxs(q,{value:"maintenance",className:"space-y-4",children:[e.jsxs(b,{children:[e.jsx(A,{children:e.jsxs($,{className:"text-foreground flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5"}),"Platform Maintenance Settings"]})}),e.jsx(N,{className:"space-y-6",children:Ns?e.jsx(T,{className:"h-64"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`p-4 rounded-lg border ${o?.mode==="none"?"bg-green-950/30 border-green-700":"bg-destructive/10 border-destructive"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[o?.mode==="none"?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(Fe,{className:"h-6 w-6 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold ${o?.mode==="none"?"text-green-600":"text-destructive"}`,children:o?.mode==="none"?"Platform is ONLINE":"Platform is in MAINTENANCE MODE"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:o?.mode==="none"?"All features are operational":`Mode: ${o?.mode?.toUpperCase()} - ${o?.customReason||"No reason specified"}`})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-foreground text-lg font-semibold",children:"Maintenance Mode"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[{value:"none",label:"None (Online)",desc:"Everything works normally",color:"green"},{value:"trading",label:"Trading/Order Maintenance",desc:"Orders disabled, wallet & login work",color:"yellow"},{value:"financial",label:"Financial Maintenance",desc:"Deposits & withdrawals disabled only",color:"orange"},{value:"readonly",label:"Read-Only Mode",desc:"Emergency: view only, no actions",color:"blue"},{value:"full",label:"Full Maintenance",desc:"Login disabled, super-admin only",color:"red"}].map(s=>e.jsxs("button",{onClick:()=>{s.value!=="none"&&o?.mode==="none"?je(s.value):L.mutate({mode:s.value})},disabled:L.isPending,className:`p-4 rounded-lg border-2 text-left transition-all ${o?.mode===s.value?s.value==="none"?"border-green-500 bg-green-950/30":"border-red-500 bg-destructive/10":"border-border bg-card/50 hover:border-primary"}`,"data-testid":`maintenance-mode-${s.value}`,children:[e.jsx("p",{className:`font-bold ${o?.mode===s.value?s.value==="none"?"text-green-600":"text-destructive":"text-foreground"}`,children:s.label}),e.jsx("p",{className:"text-muted-foreground text-xs mt-1",children:s.desc})]},s.value))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-foreground",children:"Custom Reason / Message for Users"}),e.jsx(Y,{placeholder:"We are upgrading our systems to improve security and performance...",value:X||o?.customReason||"",onChange:s=>{Re(s.target.value),pe(!0)},"data-testid":"maintenance-custom-reason"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-foreground",children:"Expected Downtime"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(qs,{placeholder:"e.g., 2 hours, 30 minutes",className:"max-w-xs",value:re||o?.expectedDowntime||"",onChange:s=>{ms(s.target.value),pe(!0)},"data-testid":"maintenance-expected-downtime"}),e.jsx(Ze,{className:"h-10 w-10 text-muted-foreground"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{className:"bg-blue-600 hover:bg-blue-700",onClick:()=>{L.mutate({customReason:X||o?.customReason||"",expectedDowntime:re||o?.expectedDowntime||""}),pe(!1)},disabled:L.isPending||!Ae,"data-testid":"button-save-maintenance-settings",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Save Message & Downtime"]}),Ae&&e.jsxs("p",{className:"text-yellow-400 text-sm flex items-center",children:[e.jsx(Os,{className:"h-4 w-4 mr-1"}),"You have unsaved changes"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{className:"text-foreground text-lg font-semibold",children:"Feature Controls"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{key:"loginEnabled",label:"Login Enabled",desc:"Allow users to log in"},{key:"depositsEnabled",label:"Deposits Enabled",desc:"Allow deposits to wallets"},{key:"withdrawalsEnabled",label:"Withdrawals Enabled",desc:"Allow withdrawals from wallets"},{key:"tradingEnabled",label:"Trading Enabled",desc:"Allow creating new orders"},{key:"autoWithdrawalEnabled",label:"Automatic Withdrawals",desc:"Enable instant withdrawals without admin approval"},{key:"kycRequired",label:"KYC Requirement",desc:"Require KYC verification to post ads"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg border border-border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground font-medium",children:s.label}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.desc})]}),e.jsx(cs,{checked:o?.[s.key]??(s.key==="loginEnabled"||s.key==="depositsEnabled"||s.key==="withdrawalsEnabled"||s.key==="tradingEnabled"),onCheckedChange:t=>L.mutate({[s.key]:t}),"data-testid":`toggle-${s.key}`})]},s.key))})]}),o?.mode!=="none"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-foreground text-lg font-semibold",children:"User Preview"}),e.jsx("div",{className:"p-6 bg-card rounded-lg border border-border",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-5xl",children:"ðŸš§"}),e.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Platform Under Maintenance"}),e.jsx("p",{className:"text-muted-foreground",children:X||o?.customReason||"We are upgrading our systems to improve security and performance."}),(re||o?.expectedDowntime)&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-yellow-400",children:[e.jsx(Ze,{className:"h-5 w-5"}),e.jsxs("span",{children:["Estimated time: ",re||o?.expectedDowntime]})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 pt-4",children:[!o?.depositsEnabled&&e.jsx(v,{variant:"outline",className:"bg-red-500/10 text-red-400 border-red-500",children:"Deposits Disabled"}),!o?.withdrawalsEnabled&&e.jsx(v,{variant:"outline",className:"bg-red-500/10 text-red-400 border-red-500",children:"Withdrawals Disabled"}),!o?.tradingEnabled&&e.jsx(v,{variant:"outline",className:"bg-red-500/10 text-red-400 border-red-500",children:"Trading Disabled"}),!o?.loginEnabled&&e.jsx(v,{variant:"outline",className:"bg-red-500/10 text-red-400 border-red-500",children:"Login Disabled"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Thank you for your patience."})]})})]}),o?.updatedAt&&e.jsxs("p",{className:"text-gray-500 text-sm",children:["Last updated: ",new Date(o.updatedAt).toLocaleString()]})]})})]}),e.jsxs(b,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(A,{children:e.jsxs($,{className:"text-white flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"Master Wallet Controls"]})}),e.jsx(N,{className:"space-y-4",children:e.jsx(ot,{})})]}),e.jsx(B,{open:!!J,onOpenChange:()=>je(null),children:e.jsxs(z,{className:"bg-gray-900 border-gray-800",children:[e.jsxs(V,{children:[e.jsxs(O,{className:"text-white flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-yellow-500"}),"Enable Maintenance Mode?"]}),e.jsx(de,{className:"text-gray-400",children:"This will affect all users on the platform. Make sure you have notified your team before proceeding."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-700 rounded-lg",children:e.jsxs("p",{className:"text-yellow-400 text-sm",children:[e.jsx("strong",{children:"Warning:"})," Enabling ",J==="full"?"Full Maintenance":J==="financial"?"Financial Maintenance":J==="trading"?"Trading Maintenance":"Read-Only Mode"," ","will restrict user access to the platform."]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-gray-400",children:"Reason for maintenance (optional):"}),e.jsx(Y,{placeholder:"Scheduled system upgrade...",className:"bg-gray-800 border-gray-700 text-white",value:X,onChange:s=>Re(s.target.value)})]})]}),e.jsxs(_,{children:[e.jsx(se,{asChild:!0,children:e.jsx(d,{variant:"outline",className:"border-gray-700",children:"Cancel"})}),e.jsxs(d,{className:"bg-red-600 hover:bg-red-700",onClick:()=>{L.mutate({mode:J,customReason:X||void 0}),je(null)},disabled:L.isPending,"data-testid":"button-confirm-maintenance",children:[e.jsx(Hs,{className:"h-4 w-4 mr-2"}),"Enable Maintenance"]})]})]})})]})]}),e.jsx(B,{open:!!h,onOpenChange:()=>be(),children:e.jsxs(z,{className:"bg-gray-900 border-gray-800 max-w-4xl max-h-[90vh]",children:[e.jsxs(V,{children:[e.jsxs(O,{className:"text-white flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"KYC Documents Review"]}),e.jsx(de,{className:"text-gray-400",children:"Review all uploaded verification documents"})]}),h&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative",children:(()=>{const s=fe(h),t=s[I];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(v,{className:"bg-blue-600",children:[t?.label," (",I+1,"/",s.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",className:"border-gray-700",onClick:xs,disabled:s.length<=1,children:e.jsx(_s,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",className:"border-gray-700",onClick:us,disabled:s.length<=1,children:e.jsx(Ls,{className:"h-4 w-4"})})]})]}),t&&e.jsx("div",{className:"flex justify-center bg-gray-800 rounded-lg p-4",children:e.jsx("img",{src:t.url,alt:t.label,className:"max-h-[60vh] max-w-full object-contain rounded-lg","data-testid":"document-viewer-image"})}),e.jsx("div",{className:"flex gap-2 mt-4 justify-center",children:s.map((w,ee)=>e.jsx("button",{onClick:()=>F(ee),className:`w-20 h-14 rounded-lg overflow-hidden border-2 transition-all ${ee===I?"border-blue-500":"border-gray-700 opacity-60 hover:opacity-100"}`,children:e.jsx("img",{src:w.url,alt:w.label,className:"w-full h-full object-cover"})},ee))})]})})()}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"ID Type"}),e.jsx("p",{className:"text-white",children:h.idType||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"ID Number"}),e.jsx("p",{className:"text-white",children:h.idNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Face Match"}),e.jsx("p",{className:"text-white",children:h.faceMatchScore?`${h.faceMatchScore}%`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Status"}),e.jsx(v,{variant:"outline",className:"bg-yellow-500/10 text-yellow-500 border-yellow-500",children:h.status})]})]})]}),e.jsxs(_,{children:[e.jsx(d,{variant:"outline",className:"border-gray-700",onClick:be,children:"Close"}),h&&R(h)&&e.jsxs(d,{className:"bg-green-600 hover:bg-green-700",onClick:()=>{Ke(h),be()},children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Approve KYC"]})]})]})})]})})}export{Ot as default};
