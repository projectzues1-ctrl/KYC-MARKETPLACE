import{d as as,u as rs,g as ts,b as ls,r as n,a as h,j as e,S as u,f as o}from"./index-B6hPo9fH.js";import{u as y}from"./useMutation-C_3TpXjp.js";import{L as ds,G as X}from"./Layout-BTVfT1Q4.js";import{C as k,a as w,b as qe,c as ns}from"./card-Cl1MO1GN.js";import{B as d}from"./button-DdYfvWb9.js";import{B as p}from"./badge-Dn4EaI7W.js";import{I as Z}from"./input-vnQcFn7U.js";import{T as Y}from"./textarea-Cc28xWq-.js";import{T as is,a as os,b as Ue,c as Te}from"./tabs-YN5y1_yR.js";import{D as ce,a as xe,b as ge,c as me,e as ue}from"./dialog-D_lwzFP4.js";import{u as cs}from"./useTranslation-O3_Fa0eH.js";import{L as xs}from"./loader-circle-bHqV6n7f.js";import{T as ee}from"./triangle-alert-DGpOeCBb.js";import{C as Ee}from"./clock-BbwHj01_.js";import{C as U}from"./circle-check-big-BkJjytOF.js";import{S as F}from"./shield-DVigj7cn.js";import{F as se}from"./flag-CuHtVT3T.js";import{U as z}from"./index-Dt-oTuiC.js";import{B as S}from"./ban-BNghf3i0.js";import{M as pe,S as Be}from"./send-DvM8hF-_.js";import{B as he}from"./badge-check-D3unhvu5.js";import{D as Ie}from"./dollar-sign-pMvEizJe.js";import{C as Me}from"./circle-x-Cd9ohy9Q.js";import{E as Oe}from"./eye-DoMSfCwj.js";import"./ThemeToggle-Cd9vwdUm.js";import"./shopping-cart-DT7LSJeM.js";function Is(){const{t:gs}=cs(),{toast:i}=as(),x=rs(),ye=ts(),[,Pe]=ls(),[g,ae]=n.useState(null),[T,be]=n.useState(""),[C,je]=n.useState(""),[E,re]=n.useState(""),[Ne,te]=n.useState(null),[Ke,B]=n.useState(!1),[j,ve]=n.useState(!1),[Qe,D]=n.useState(!1),[I,M]=n.useState(""),[O,P]=n.useState(null),[fe,L]=n.useState(""),[K,We]=n.useState("marketplace"),[c,R]=n.useState(null),[b,ke]=n.useState(""),[Q,we]=n.useState(""),[Fe,W]=n.useState(null),[_e,A]=n.useState(!1),[_,le]=n.useState(""),[N,ze]=n.useState("open");if(ye?.role!=="dispute_admin"&&ye?.role!=="admin")return Pe("/"),null;const{data:J,isLoading:Je}=h({queryKey:["disputeStats"],queryFn:async()=>{const s=await o("/api/admin/disputes/stats");if(!s.ok)throw new Error("Failed to fetch stats");return s.json()}}),{data:H,isLoading:He}=h({queryKey:["openDisputes"],queryFn:async()=>{const s=await o("/api/admin/disputes");if(!s.ok)throw new Error("Failed to fetch disputes");return s.json()}}),{data:de,isLoading:Ve}=h({queryKey:["resolvedDisputes"],queryFn:async()=>{const s=await o("/api/admin/disputes/resolved");if(!s.ok)throw new Error("Failed to fetch resolved disputes");return s.json()},enabled:j}),{data:t,isLoading:Ge}=h({queryKey:["disputeDetails",g],queryFn:async()=>{const s=await o(`/api/admin/disputes/${g}/details`);if(!s.ok)throw new Error("Failed to fetch dispute details");return s.json()},enabled:!!g,refetchInterval:g?5e3:!1}),{data:V,isLoading:Xe}=h({queryKey:["loaderDisputes"],queryFn:async()=>{const s=await o("/api/admin/loader-disputes");return s.ok?s.json():[]},enabled:K==="loaders"}),{data:$,isLoading:Ze}=h({queryKey:["loaderDisputeStats"],queryFn:async()=>{const s=await o("/api/admin/loader-disputes/stats");return s.ok?s.json():{openCount:0,resolvedCount:0,inReviewCount:0,totalCount:0}},enabled:K==="loaders"}),{data:ne,isLoading:Ye}=h({queryKey:["resolvedLoaderDisputes"],queryFn:async()=>{const s=await o("/api/admin/loader-disputes/resolved");return s.ok?s.json():[]},enabled:K==="loaders"&&N==="resolved"}),{data:a,isLoading:Se}=h({queryKey:["loaderDisputeDetails",c],queryFn:async()=>{const s=await o(`/api/admin/loader-disputes/${c}/details`);if(!s.ok)throw new Error("Failed to fetch dispute details");return s.json()},enabled:!!c,refetchInterval:c?5e3:!1}),Ce=y({mutationFn:async s=>{const r=await o(`/api/admin/loader-disputes/${c}/message`,{method:"POST",body:JSON.stringify({message:s})});if(!r.ok)throw new Error("Failed to send message");return r.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["loaderDisputeDetails",c]}),we(""),i({title:"Message sent"})},onError:()=>{i({variant:"destructive",title:"Failed to send message"})}}),ie=y({mutationFn:async({userId:s,reason:r})=>{const l=await o(`/api/admin/users/${s}/freeze`,{method:"POST",body:JSON.stringify({reason:r})});if(!l.ok)throw new Error("Failed to freeze user");return l.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["loaderDisputeDetails",c]}),A(!1),le(""),W(null),i({title:"User Frozen",description:"Account has been frozen for investigation"})},onError:()=>{i({variant:"destructive",title:"Failed to freeze user"})}}),De=y({mutationFn:async s=>{const r=await o(`/api/admin/users/${s}/unfreeze`,{method:"POST"});if(!r.ok)throw new Error("Failed to unfreeze user");return r.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["loaderDisputeDetails",c]}),i({title:"User Unfrozen"})},onError:()=>{i({variant:"destructive",title:"Failed to unfreeze user"})}}),v=y({mutationFn:async({disputeId:s,winner:r,resolution:l})=>{const m=await o(`/api/admin/loader-disputes/${s}/resolve`,{method:"POST",body:JSON.stringify({winner:r,resolution:l})});if(!m.ok){const G=await m.json();throw new Error(G.message||"Failed to resolve dispute")}return m.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["loaderDisputes"]}),x.invalidateQueries({queryKey:["loaderDisputeStats"]}),x.invalidateQueries({queryKey:["resolvedLoaderDisputes"]}),R(null),ke(""),i({title:"Dispute Resolved",description:"Loader zone dispute has been resolved"})},onError:s=>{i({variant:"destructive",title:"Failed to resolve dispute",description:s.message})}}),Le=y({mutationFn:async s=>{const r=await o(`/api/admin/disputes/${g}/message`,{method:"POST",body:JSON.stringify({message:s})});if(!r.ok)throw new Error("Failed to send message");return r.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["disputeDetails",g]}),be(""),i({title:"Message sent"})},onError:()=>{i({variant:"destructive",title:"Failed to send message"})}}),q=y({mutationFn:async({status:s,resolution:r,twoFactorToken:l,amount:m})=>{const G=await o(`/api/admin/disputes/${g}/resolve`,{method:"POST",body:JSON.stringify({status:s,resolution:r,adminNotes:r,twoFactorToken:l,amount:m})}),f=await G.json();if(!G.ok)throw f.requires2FA?{requires2FA:!0,message:f.message}:f.requires2FASetup?{requires2FASetup:!0,message:f.message}:new Error(f.message||"Failed to resolve dispute");return f},onSuccess:(s,r)=>{x.invalidateQueries({queryKey:["openDisputes"]}),x.invalidateQueries({queryKey:["disputeStats"]}),x.invalidateQueries({queryKey:["resolvedDisputes"]}),x.invalidateQueries({queryKey:["disputeDetails",g]}),ae(null),je(""),D(!1),M(""),P(null),L("");const l=r.status==="resolved_refund"?"refunded to buyer":"released to seller",m=s.releasedAmount?` ($${s.releasedAmount})`:"";i({title:"Dispute Resolved",description:`Funds have been ${l}${m}`})},onError:s=>{if(s.requires2FA){D(!0);return}if(s.requires2FASetup){i({variant:"destructive",title:"2FA Required",description:s.message});return}i({variant:"destructive",title:"Failed to resolve dispute",description:s.message})}}),Re=s=>{P(s),D(!0)},es=()=>{O&&C.trim()&&I.trim()&&q.mutate({status:O,resolution:C,twoFactorToken:I,amount:fe||void 0})},oe=y({mutationFn:async({userId:s,reason:r})=>{const l=await o(`/api/admin/users/${s}/freeze`,{method:"POST",body:JSON.stringify({reason:r})});if(!l.ok)throw new Error("Failed to freeze user");return l.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["disputeDetails",g]}),B(!1),re(""),te(null),i({title:"User Frozen",description:"Account has been frozen for investigation"})},onError:()=>{i({variant:"destructive",title:"Failed to freeze user"})}}),Ae=y({mutationFn:async s=>{const r=await o(`/api/admin/users/${s}/unfreeze`,{method:"POST"});if(!r.ok)throw new Error("Failed to unfreeze user");return r.json()},onSuccess:()=>{x.invalidateQueries({queryKey:["disputeDetails",g]}),i({title:"User Unfrozen"})},onError:()=>{i({variant:"destructive",title:"Failed to unfreeze user"})}}),ss=s=>{s.preventDefault(),T.trim()&&Le.mutate(T)},$e=s=>{te(s),B(!0)};return e.jsx(ds,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:"h-8 w-8 text-orange-500"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dispute Resolution Center"})]}),e.jsxs(is,{value:K,onValueChange:s=>We(s),className:"w-full",children:[e.jsxs(os,{className:"bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700",children:[e.jsx(Ue,{value:"marketplace",className:"data-[state=active]:bg-orange-600","data-testid":"tab-marketplace-disputes",children:"Marketplace Disputes"}),e.jsxs(Ue,{value:"loaders",className:"data-[state=active]:bg-purple-600","data-testid":"tab-loader-disputes",children:[e.jsx(xs,{className:"h-4 w-4 mr-1"}),"Loaders Zone (",V?.length||0,")"]})]}),e.jsx(Te,{value:"loaders",className:"mt-4",children:e.jsxs("div",{className:"space-y-6",children:[Ze?e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[1,2,3,4].map(s=>e.jsx(u,{className:"h-24 bg-gray-200 dark:bg-gray-800"},s))}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 bg-gradient-to-br from-orange-900/40 to-purple-900/30 border-2 border-orange-500 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"h-10 w-10 text-orange-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-300 text-sm font-medium",children:"Open Cases"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:$?.openCount||0})]})]})}),e.jsx("div",{className:"p-4 bg-gradient-to-br from-yellow-900/40 to-purple-900/30 border-2 border-orange-500 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{className:"h-10 w-10 text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-300 text-sm font-medium",children:"In Review"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:$?.inReviewCount||0})]})]})}),e.jsx("div",{className:"p-4 bg-gradient-to-br from-teal-900/40 to-purple-900/30 border-2 border-teal-500 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-10 w-10 text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 text-sm font-medium",children:"Resolved"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:$?.resolvedCount||0})]})]})}),e.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-800/80 border-2 border-gray-400 dark:border-gray-600 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"h-10 w-10 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm font-medium",children:"Total Cases"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:$?.totalCount||0})]})]})})]}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsxs(d,{variant:N==="open"?"outline":"ghost",className:`flex items-center gap-2 ${N==="open"?"border-gray-400 dark:border-gray-500 bg-gray-200 dark:bg-gray-800":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{ze("open"),R(null)},"data-testid":"button-loader-disputes-open",children:[e.jsx(ee,{className:"h-4 w-4"}),"Open (",$?.openCount||0,")"]}),e.jsxs(d,{variant:N==="resolved"?"default":"ghost",className:`flex items-center gap-2 ${N==="resolved"?"bg-green-600 hover:bg-green-700":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,onClick:()=>{ze("resolved"),R(null)},"data-testid":"button-loader-disputes-resolved",children:[e.jsx(U,{className:"h-4 w-4"}),"Resolved"]})]}),N==="open"?Xe?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx(u,{className:"h-20 bg-gray-200 dark:bg-gray-700"},s))}):V&&V.length>0?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:V.map(s=>e.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-colors ${c===s.id?"bg-purple-900/50 border border-purple-600":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,onClick:()=>R(s.id),"data-testid":`loader-dispute-item-${s.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium text-sm",children:["Order #",s.orderId.slice(0,8)]}),e.jsx(p,{className:"bg-orange-600 text-xs",children:s.status})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2",children:s.reason}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-500 text-xs",children:["$",s.order?.dealAmount||"0"," • ",new Date(s.createdAt).toLocaleDateString()]}),s.openerUsername&&e.jsxs(p,{variant:"outline",className:"text-[10px] px-1.5 py-0 border-amber-500 text-amber-600 dark:text-amber-400",children:[e.jsx(se,{className:"h-2 w-2 mr-1"}),s.openerUsername]})]})]},s.id))}),e.jsx("div",{className:"lg:col-span-2",children:c?Se?e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{className:"h-32 bg-gray-200 dark:bg-gray-700"}),e.jsx(u,{className:"h-64 bg-gray-200 dark:bg-gray-700"})]}):a?e.jsxs("div",{className:"space-y-4 bg-gray-200 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"})," Loader"]}),a.loader?.isFrozen&&e.jsx(p,{className:"bg-red-600 text-xs",children:"Frozen"})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:a.loader?.username||"Unknown"}),a.loaderWallet&&e.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Bal: $",parseFloat(a.loaderWallet.availableBalance).toFixed(2)," | Esc: $",parseFloat(a.loaderWallet.escrowBalance).toFixed(2)]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[a.loader&&!a.loader.isFrozen&&e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>{W(a.loader.id),A(!0)},"data-testid":"button-freeze-loader",children:[e.jsx(S,{className:"h-3 w-3 mr-1"})," Freeze"]}),a.loader?.isFrozen&&e.jsx(d,{size:"sm",variant:"outline",onClick:()=>De.mutate(a.loader.id),"data-testid":"button-unfreeze-loader",children:"Unfreeze"})]})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"})," Receiver"]}),a.receiver?.isFrozen&&e.jsx(p,{className:"bg-red-600 text-xs",children:"Frozen"})]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:a.receiver?.username||"Unknown"}),a.receiverWallet&&e.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Bal: $",parseFloat(a.receiverWallet.availableBalance).toFixed(2)," | Esc: $",parseFloat(a.receiverWallet.escrowBalance).toFixed(2)]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[a.receiver&&!a.receiver.isFrozen&&e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>{W(a.receiver.id),A(!0)},"data-testid":"button-freeze-receiver",children:[e.jsx(S,{className:"h-3 w-3 mr-1"})," Freeze"]}),a.receiver?.isFrozen&&e.jsx(d,{size:"sm",variant:"outline",onClick:()=>De.mutate(a.receiver.id),"data-testid":"button-unfreeze-receiver",children:"Unfreeze"})]})]})]}),e.jsxs("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 border border-purple-300 dark:border-purple-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-purple-700 dark:text-purple-300 text-sm font-medium",children:"Dispute Reason"}),a.dispute.openedBy&&e.jsxs(p,{className:"bg-amber-600 text-xs flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),"Opened by: ",a.dispute.openedBy===a.order.loaderId?a.loader?.username:a.receiver?.username]})]}),e.jsx("p",{className:"text-gray-900 dark:text-white text-sm",children:a.dispute.reason}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-xs mt-2",children:["Deal: ",e.jsxs("span",{className:"text-gray-900 dark:text-white font-bold",children:["$",parseFloat(a.order.dealAmount).toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-3",children:[e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium mb-2 flex items-center gap-2 text-sm",children:[e.jsx(pe,{className:"h-4 w-4"})," Chat History"]}),e.jsx("div",{className:"h-32 overflow-y-auto space-y-2 mb-3 p-2 bg-gray-200 dark:bg-gray-900 rounded",children:a.chatMessages.length>0?a.chatMessages.map(s=>{const r=s.senderRole==="admin"||s.senderRole==="dispute_admin",l=s.senderId===a.order.loaderId,m=s.senderName||(l?a.loader?.username:a.receiver?.username)||"Unknown";return e.jsxs("div",{className:"text-xs p-2 bg-gray-300 dark:bg-gray-800/50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`font-medium ${r?"text-purple-600 dark:text-purple-400":l?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"}`,children:m}),r&&e.jsxs("span",{className:"flex items-center gap-1 px-1 py-0.5 bg-purple-600/20 rounded text-xs text-purple-700 dark:text-purple-300",children:[e.jsx(he,{className:"h-2 w-2"}),"Admin"]}),!r&&e.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${l?"bg-blue-600/20 text-blue-700 dark:text-blue-300":"bg-green-600/20 text-green-700 dark:text-green-300"}`,children:l?"Loader":"Receiver"}),e.jsx("span",{className:"text-gray-500 text-xs ml-auto",children:new Date(s.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:s.content})]},s.id)}):e.jsx("p",{className:"text-gray-500 text-center py-2 text-xs",children:"No messages"})}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),Q.trim()&&Ce.mutate(Q)},className:"flex gap-2",children:[e.jsx(Z,{placeholder:"Send message...",className:"flex-1 bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white text-sm",value:Q,onChange:s=>we(s.target.value),"data-testid":"input-loader-admin-message"}),e.jsx(d,{type:"submit",size:"sm",className:"bg-purple-600 hover:bg-purple-700",disabled:!Q.trim()||Ce.isPending,"data-testid":"button-send-loader-admin-message",children:e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{placeholder:"Resolution notes...",className:"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white text-sm",value:b,onChange:s=>ke(s.target.value),rows:2,"data-testid":"input-loader-resolution"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",className:"flex-1 bg-green-600 hover:bg-green-700",onClick:()=>v.mutate({disputeId:c,winner:"loader",resolution:b}),disabled:!b.trim()||v.isPending,"data-testid":"button-resolve-loader-wins",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"})," Loader Wins"]}),e.jsxs(d,{size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700",onClick:()=>v.mutate({disputeId:c,winner:"receiver",resolution:b}),disabled:!b.trim()||v.isPending,"data-testid":"button-resolve-receiver-wins",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"})," Receiver Wins"]})]}),e.jsx(d,{size:"sm",variant:"outline",className:"w-full border-gray-600",onClick:()=>v.mutate({disputeId:c,winner:"mutual",resolution:b}),disabled:!b.trim()||v.isPending,"data-testid":"button-resolve-mutual",children:"Split"})]})]}):null:e.jsxs("div",{className:"text-center py-12 bg-gray-200 dark:bg-gray-700/50 rounded-lg",children:[e.jsx(X,{className:"h-16 w-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Select a dispute to view details"})]})})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(F,{className:"h-16 w-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"No open disputes"})]}):Ye?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx(u,{className:"h-20 bg-gray-200 dark:bg-gray-700"},s))}):ne&&ne.length>0?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:ne.map(s=>e.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-colors ${c===s.id?"bg-green-900/50 border border-green-600":"bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600"}`,onClick:()=>R(s.id),"data-testid":`loader-resolved-dispute-${s.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium text-sm",children:["Order #",s.orderId.slice(0,8)]}),e.jsx(p,{className:"bg-green-600 text-xs",children:s.status})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2",children:s.reason}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-500 text-xs",children:["$",s.order?.dealAmount||"0"," • ",s.resolvedAt?new Date(s.resolvedAt).toLocaleDateString():"N/A"]}),s.openerUsername&&e.jsxs(p,{variant:"outline",className:"text-[10px] px-1.5 py-0 border-amber-500 text-amber-600 dark:text-amber-400",children:[e.jsx(se,{className:"h-2 w-2 mr-1"}),s.openerUsername]})]}),s.resolverName&&e.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Resolved by ",s.resolverName]})]},s.id))}),e.jsx("div",{className:"lg:col-span-2",children:c?Se?e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{className:"h-32 bg-gray-200 dark:bg-gray-700"}),e.jsx(u,{className:"h-64 bg-gray-200 dark:bg-gray-700"})]}):a?e.jsxs("div",{className:"space-y-4 bg-gray-200 dark:bg-gray-700/50 rounded-lg p-4",children:[e.jsxs("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700 rounded-lg",children:[e.jsx("p",{className:"text-green-700 dark:text-green-300 text-sm font-medium mb-1",children:"Resolution"}),e.jsx("p",{className:"text-gray-900 dark:text-white text-sm",children:a.dispute.status.replace(/_/g," ").replace(/^\w/,s=>s.toUpperCase())})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1 mb-2",children:[e.jsx(z,{className:"h-4 w-4"})," Loader"]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:a.loader?.username||"Unknown"})]}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1 mb-2",children:[e.jsx(z,{className:"h-4 w-4"})," Receiver"]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:a.receiver?.username||"Unknown"})]})]}),e.jsxs("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 border border-purple-300 dark:border-purple-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-purple-700 dark:text-purple-300 text-sm font-medium",children:"Dispute Reason"}),a.dispute.openedBy&&e.jsxs(p,{className:"bg-amber-600 text-xs flex items-center gap-1",children:[e.jsx(se,{className:"h-3 w-3"}),"Opened by: ",a.dispute.openedBy===a.order.loaderId?a.loader?.username:a.receiver?.username]})]}),e.jsx("p",{className:"text-gray-900 dark:text-white text-sm",children:a.dispute.reason}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-xs mt-2",children:["Deal: ",e.jsxs("span",{className:"text-gray-900 dark:text-white font-bold",children:["$",parseFloat(a.order.dealAmount).toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-3",children:[e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium mb-2 flex items-center gap-2 text-sm",children:[e.jsx(pe,{className:"h-4 w-4"})," Chat History"]}),e.jsx("div",{className:"h-32 overflow-y-auto space-y-2 p-2 bg-gray-200 dark:bg-gray-900 rounded",children:a.chatMessages.length>0?a.chatMessages.map(s=>{const r=s.senderRole==="admin"||s.senderRole==="dispute_admin",l=s.senderId===a.order.loaderId,m=s.senderName||(l?a.loader?.username:a.receiver?.username)||"Unknown";return e.jsxs("div",{className:"text-xs p-2 bg-gray-300 dark:bg-gray-800/50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`font-medium ${r?"text-purple-600 dark:text-purple-400":l?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"}`,children:m}),r&&e.jsxs("span",{className:"flex items-center gap-1 px-1 py-0.5 bg-purple-600/20 rounded text-xs text-purple-700 dark:text-purple-300",children:[e.jsx(he,{className:"h-2 w-2"}),"Admin"]}),!r&&e.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${l?"bg-blue-600/20 text-blue-700 dark:text-blue-300":"bg-green-600/20 text-green-700 dark:text-green-300"}`,children:l?"Loader":"Receiver"}),e.jsx("span",{className:"text-gray-500 text-xs ml-auto",children:new Date(s.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:s.content})]},s.id)}):e.jsx("p",{className:"text-gray-500 text-center py-2 text-xs",children:"No messages"})})]})]}):null:e.jsxs("div",{className:"text-center py-12 bg-gray-200 dark:bg-gray-700/50 rounded-lg",children:[e.jsx(Oe,{className:"h-16 w-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Select a resolved dispute to review details"})]})})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(F,{className:"h-16 w-16 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"No resolved disputes"})]})]})]})}),e.jsxs(Te,{value:"marketplace",className:"mt-4",children:[Je?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(s=>e.jsx(u,{className:"h-24 bg-gray-200 dark:bg-gray-800"},s))}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(k,{className:"bg-orange-100 dark:bg-orange-900/30 border-orange-300 dark:border-orange-700",children:e.jsxs(w,{className:"p-4 flex items-center gap-3",children:[e.jsx(ee,{className:"h-8 w-8 text-orange-500 dark:text-orange-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-600 dark:text-orange-300 text-sm",children:"Open Cases"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:J?.openCount||0})]})]})}),e.jsx(k,{className:"bg-yellow-100 dark:bg-yellow-900/30 border-yellow-300 dark:border-yellow-700",children:e.jsxs(w,{className:"p-4 flex items-center gap-3",children:[e.jsx(Ee,{className:"h-8 w-8 text-yellow-600 dark:text-yellow-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-600 dark:text-yellow-300 text-sm",children:"In Review"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:J?.inReviewCount||0})]})]})}),e.jsx(k,{className:"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700",children:e.jsxs(w,{className:"p-4 flex items-center gap-3",children:[e.jsx(U,{className:"h-8 w-8 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-600 dark:text-green-300 text-sm",children:"Resolved"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:J?.resolvedCount||0})]})]})}),e.jsx(k,{className:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700",children:e.jsxs(w,{className:"p-4 flex items-center gap-3",children:[e.jsx(F,{className:"h-8 w-8 text-gray-500 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Total Cases"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:J?.totalCount||0})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(k,{className:"bg-white dark:bg-gray-900/50 border-gray-200 dark:border-gray-800 lg:col-span-1",children:[e.jsx(qe,{children:e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs(d,{size:"sm",variant:j?"outline":"default",className:j?"border-gray-700":"bg-orange-600 hover:bg-orange-700",onClick:()=>ve(!1),"data-testid":"button-show-open-disputes",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Open (",H?.length||0,")"]}),e.jsxs(d,{size:"sm",variant:j?"default":"outline",className:j?"bg-green-600 hover:bg-green-700":"border-gray-700",onClick:()=>ve(!0),"data-testid":"button-show-resolved-disputes",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Resolved"]})]})}),e.jsx(w,{children:j?Ve?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx(u,{className:"h-20 bg-gray-200 dark:bg-gray-800"},s))}):de&&de.length>0?e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:de.map(s=>e.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-colors ${g===s.id?"bg-green-900/50 border border-green-600":"bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>ae(s.id),"data-testid":`resolved-dispute-item-${s.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium text-sm",children:["Order #",s.orderId.slice(0,8)]}),e.jsx(p,{className:s.status==="resolved_refund"?"bg-blue-600 text-xs":"bg-green-600 text-xs",children:s.status==="resolved_refund"?"Refunded":"Released"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2",children:s.resolution||s.reason}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("p",{className:"text-gray-500 text-xs",children:s.resolvedAt?new Date(s.resolvedAt).toLocaleDateString():""}),s.resolverName&&e.jsxs("p",{className:"text-green-400 text-xs flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),s.resolverName]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No resolved disputes"})]}):He?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx(u,{className:"h-20 bg-gray-200 dark:bg-gray-800"},s))}):H&&H.length>0?e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:H.map(s=>e.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-colors ${g===s.id?"bg-orange-900/50 border border-orange-600":"bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>ae(s.id),"data-testid":`dispute-item-${s.id}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium text-sm",children:["Order #",s.orderId.slice(0,8)]}),e.jsx(p,{className:"bg-orange-600 text-xs",children:s.status==="open"?"Open":"In Review"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2",children:s.reason}),e.jsx("p",{className:"text-gray-600 dark:text-gray-500 text-xs mt-1",children:new Date(s.createdAt).toLocaleDateString()})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"h-12 w-12 text-green-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No open disputes"})]})})]}),e.jsxs(k,{className:"bg-white dark:bg-gray-900/50 border-gray-200 dark:border-gray-800 lg:col-span-2",children:[e.jsx(qe,{children:e.jsxs(ns,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5 text-purple-400"}),"Dispute Details"]})}),e.jsx(w,{children:g?Ge?e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{className:"h-32 bg-gray-200 dark:bg-gray-800"}),e.jsx(u,{className:"h-64 bg-gray-200 dark:bg-gray-800"})]}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"})," Buyer"]}),t.buyer?.isFrozen?e.jsx(p,{className:"bg-red-600 text-xs",children:"Frozen"}):null]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:t.buyer?.username||"Unknown"}),t.buyerWallet&&e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Balance: $",parseFloat(t.buyerWallet.availableBalance).toFixed(2)," | Escrow: $",parseFloat(t.buyerWallet.escrowBalance).toFixed(2)]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[t.buyer&&!t.buyer.isFrozen&&e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>$e(t.buyer.id),"data-testid":"button-freeze-buyer",children:[e.jsx(S,{className:"h-3 w-3 mr-1"})," Freeze"]}),t.buyer?.isFrozen&&e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Ae.mutate(t.buyer.id),"data-testid":"button-unfreeze-buyer",children:"Unfreeze"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-100 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-gray-400 text-sm flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"})," Seller"]}),t.seller?.isFrozen?e.jsx(p,{className:"bg-red-600 text-xs",children:"Frozen"}):null]}),e.jsx("p",{className:"text-gray-900 dark:text-white font-bold",children:t.seller?.username||"Unknown"}),t.sellerWallet&&e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Balance: $",parseFloat(t.sellerWallet.availableBalance).toFixed(2)," | Escrow: $",parseFloat(t.sellerWallet.escrowBalance).toFixed(2)]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[t.seller&&!t.seller.isFrozen&&e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>$e(t.seller.id),"data-testid":"button-freeze-seller",children:[e.jsx(S,{className:"h-3 w-3 mr-1"})," Freeze"]}),t.seller?.isFrozen&&e.jsx(d,{size:"sm",variant:"outline",onClick:()=>Ae.mutate(t.seller.id),"data-testid":"button-unfreeze-seller",children:"Unfreeze"})]})]})]}),e.jsxs("div",{className:"p-4 bg-orange-100 dark:bg-orange-900/30 border border-orange-300 dark:border-orange-700 rounded-lg",children:[e.jsx("p",{className:"text-orange-600 dark:text-orange-300 text-sm font-medium mb-1",children:"Dispute Reason"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:t.dispute.reason}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-2",children:["Amount in dispute: ",e.jsxs("span",{className:"text-gray-900 dark:text-white font-bold",children:["$",parseFloat(t.order.fiatAmount).toFixed(2)]})]})]}),e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"})," Order Chat History"]}),e.jsx("div",{className:"h-48 overflow-y-auto space-y-2 mb-4 p-2 bg-gray-200 dark:bg-gray-900 rounded",children:t.chatMessages.length>0?t.chatMessages.map(s=>{const r=s.senderRole==="admin"||s.senderRole==="dispute_admin",l=s.senderId===t.order.buyerId,m=s.senderName||(l?t.buyer?.username:t.seller?.username)||"Unknown";return e.jsxs("div",{className:"text-sm p-2 bg-gray-300 dark:bg-gray-800/50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`font-medium ${r?"text-orange-600 dark:text-orange-400":l?"text-blue-600 dark:text-blue-400":"text-green-600 dark:text-green-400"}`,children:m}),r&&e.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-orange-600/20 rounded text-xs text-orange-700 dark:text-orange-300",children:[e.jsx(he,{className:"h-3 w-3"}),"Verified Admin"]}),!r&&e.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${l?"bg-blue-600/20 text-blue-700 dark:text-blue-300":"bg-green-600/20 text-green-700 dark:text-green-300"}`,children:l?"Buyer":"Seller"}),e.jsx("span",{className:"text-gray-500 text-xs ml-auto",children:new Date(s.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:s.message})]},s.id)}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No messages"})}),e.jsxs("form",{onSubmit:ss,className:"flex gap-2",children:[e.jsx(Z,{placeholder:"Send a message to both parties...",className:"flex-1 bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white",value:T,onChange:s=>be(s.target.value),"data-testid":"input-admin-message"}),e.jsx(d,{type:"submit",className:"bg-orange-600 hover:bg-orange-700",disabled:!T.trim()||Le.isPending,"data-testid":"button-send-admin-message",children:e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Y,{placeholder:"Resolution notes (required)...",className:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white",value:C,onChange:s=>je(s.target.value),"data-testid":"input-resolution"}),e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg space-y-2",children:[e.jsx("label",{className:"text-gray-300 text-sm",children:"Release Amount (optional - leave empty for full amount)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"$"}),e.jsx(Z,{type:"number",placeholder:`Max: ${parseFloat(t.order.escrowAmount||t.order.fiatAmount).toFixed(2)}`,className:"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white",value:fe,onChange:s=>{const r=parseFloat(t.order.escrowAmount||t.order.fiatAmount),l=parseFloat(s.target.value);s.target.value?l>r?L(r.toString()):l<0?L("0"):L(s.target.value):L("")},"data-testid":"input-release-amount"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["/ ",parseFloat(t.order.escrowAmount||t.order.fiatAmount).toFixed(2)," USDT"]})]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Partial release: Specify an amount to release a portion of funds. Full amount releases all escrowed funds."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(d,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:()=>Re("resolved_release"),disabled:!C.trim()||q.isPending,"data-testid":"button-release-to-seller",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Release to Seller"]}),e.jsxs(d,{className:"flex-1 bg-blue-600 hover:bg-blue-700",onClick:()=>Re("resolved_refund"),disabled:!C.trim()||q.isPending,"data-testid":"button-refund-buyer",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Refund to Buyer"]})]})]})]}):null:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(X,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Select a dispute to view details"})]})})]})]})]})]}),e.jsx(ce,{open:Ke,onOpenChange:B,children:e.jsxs(xe,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(ge,{children:[e.jsxs(me,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-red-400"}),"Freeze Account"]}),e.jsx(ue,{className:"text-gray-400",children:"Freezing this account will prevent the user from making any transactions. This action can be reversed."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(Y,{placeholder:"Reason for freezing account (e.g., Suspected scam activity, Under investigation...)",className:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white",value:E,onChange:s=>re(s.target.value),"data-testid":"input-freeze-reason"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",className:"flex-1 border-gray-700",onClick:()=>{B(!1),re(""),te(null)},"data-testid":"button-cancel-freeze",children:"Cancel"}),e.jsx(d,{className:"flex-1 bg-red-600 hover:bg-red-700",onClick:()=>{Ne&&E.trim()&&oe.mutate({userId:Ne,reason:E})},disabled:!E.trim()||oe.isPending,"data-testid":"button-confirm-freeze",children:oe.isPending?"Freezing...":"Freeze Account"})]})]})]})}),e.jsx(ce,{open:Qe,onOpenChange:s=>{D(s),s||(M(""),P(null))},children:e.jsxs(xe,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(ge,{children:[e.jsxs(me,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-green-400"}),"Confirm with 2FA"]}),e.jsxs(ue,{className:"text-gray-400",children:["Enter your authenticator code to confirm this dispute resolution.",O==="resolved_release"?" Funds will be released to the seller.":" Funds will be refunded to the buyer."]})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(Z,{placeholder:"Enter 6-digit code",className:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white text-center text-lg tracking-widest",value:I,onChange:s=>M(s.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,"data-testid":"input-2fa-resolve"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",className:"flex-1 border-gray-700",onClick:()=>{D(!1),M(""),P(null)},"data-testid":"button-cancel-2fa",children:"Cancel"}),e.jsx(d,{className:`flex-1 ${O==="resolved_release"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,onClick:es,disabled:I.length!==6||q.isPending,"data-testid":"button-confirm-2fa-resolve",children:q.isPending?"Processing...":"Confirm Resolution"})]})]})]})}),e.jsx(ce,{open:_e,onOpenChange:A,children:e.jsxs(xe,{className:"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-800",children:[e.jsxs(ge,{children:[e.jsxs(me,{className:"text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(S,{className:"h-5 w-5 text-red-400"}),"Freeze Account"]}),e.jsx(ue,{className:"text-gray-400",children:"Freezing this account will prevent the user from making any transactions. This action can be reversed."})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(Y,{placeholder:"Reason for freezing account (e.g., Suspected scam activity, Under investigation...)",className:"bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 text-gray-900 dark:text-white",value:_,onChange:s=>le(s.target.value),"data-testid":"input-loader-freeze-reason"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",className:"flex-1 border-gray-700",onClick:()=>{A(!1),le(""),W(null)},"data-testid":"button-cancel-loader-freeze",children:"Cancel"}),e.jsx(d,{className:"flex-1 bg-red-600 hover:bg-red-700",onClick:()=>{Fe&&_.trim()&&ie.mutate({userId:Fe,reason:_})},disabled:!_.trim()||ie.isPending,"data-testid":"button-confirm-loader-freeze",children:ie.isPending?"Freezing...":"Freeze Account"})]})]})]})})]})})}export{Is as default};
