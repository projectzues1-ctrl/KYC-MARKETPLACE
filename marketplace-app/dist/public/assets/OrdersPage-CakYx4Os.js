import{a as w,j as e,S as y,L as x,f as v}from"./index-B6hPo9fH.js";import{L as C}from"./Layout-BTVfT1Q4.js";import{C as L,b as O,c as _,a as S}from"./card-Cl1MO1GN.js";import{B as l}from"./badge-Dn4EaI7W.js";import{B as u}from"./button-DdYfvWb9.js";import{T as A,a as D,b as n,c as i}from"./tabs-YN5y1_yR.js";import{u as T}from"./useTranslation-O3_Fa0eH.js";import{S as h}from"./shopping-cart-DT7LSJeM.js";import{S as m}from"./shield-DVigj7cn.js";import{A as p}from"./arrow-right-B_TWW9GO.js";import{P as k}from"./package-Rp_T8fxM.js";import{T as $}from"./triangle-alert-DGpOeCBb.js";import{C as B}from"./circle-x-Cd9ohy9Q.js";import{C as F}from"./circle-check-big-BkJjytOF.js";import{C as o}from"./clock-BbwHj01_.js";import"./ThemeToggle-Cd9vwdUm.js";import"./index-Dt-oTuiC.js";function J(){const{t:d}=T(),{data:t,isLoading:g}=w({queryKey:["orders"],queryFn:async()=>{const s=await v("/api/orders");if(!s.ok)throw new Error("Failed to fetch orders");return s.json()},retry:3,retryDelay:1e3}),j=s=>{switch(s){case"awaiting_deposit":return e.jsx(l,{className:"bg-yellow-600",children:"Awaiting Deposit"});case"escrowed":return e.jsx(l,{className:"bg-purple-600",children:"Funds Escrowed"});case"created":return e.jsx(l,{className:"bg-blue-600",children:"Pending Payment"});case"paid":return e.jsx(l,{className:"bg-yellow-600",children:"Awaiting Confirmation"});case"confirmed":return e.jsx(l,{className:"bg-purple-600",children:"Confirmed"});case"completed":return e.jsx(l,{className:"bg-green-600",children:"Completed"});case"cancelled":return e.jsx(l,{className:"bg-red-600",children:"Cancelled"});case"disputed":return e.jsx(l,{className:"bg-orange-600",children:"Disputed"});default:return e.jsx(l,{children:s})}},b=s=>{switch(s){case"awaiting_deposit":return e.jsx(o,{className:"h-5 w-5 text-yellow-400"});case"escrowed":return e.jsx(o,{className:"h-5 w-5 text-purple-400"});case"created":return e.jsx(o,{className:"h-5 w-5 text-blue-400"});case"paid":return e.jsx(o,{className:"h-5 w-5 text-yellow-400"});case"confirmed":case"completed":return e.jsx(F,{className:"h-5 w-5 text-green-400"});case"cancelled":return e.jsx(B,{className:"h-5 w-5 text-red-400"});case"disputed":return e.jsx($,{className:"h-5 w-5 text-orange-400"});default:return e.jsx(k,{className:"h-5 w-5 text-gray-400"})}},N=s=>{const r={awaiting_liability_confirmation:{label:"Select Terms",className:"bg-yellow-600"},awaiting_payment_details:{label:"Awaiting Details",className:"bg-yellow-600"},payment_details_sent:{label:"Details Sent",className:"bg-blue-600"},payment_sent:{label:"Payment Sent",className:"bg-purple-600"},completed:{label:"Completed",className:"bg-green-600"},cancelled_auto:{label:"Auto-Cancelled",className:"bg-gray-600"},cancelled_loader:{label:"Cancelled",className:"bg-red-600"},cancelled_receiver:{label:"Cancelled",className:"bg-red-600"},disputed:{label:"Disputed",className:"bg-orange-600"},resolved_loader_wins:{label:"Resolved",className:"bg-green-600"},resolved_receiver_wins:{label:"Resolved",className:"bg-green-600"},resolved_mutual:{label:"Resolved",className:"bg-gray-600"}}[s]||{label:s.replace(/_/g," "),className:"bg-gray-600"};return e.jsx(l,{className:r.className,children:r.label})},c=(s,a)=>!s||s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(h,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No orders yet"}),e.jsx("p",{className:"text-muted-foreground/70 text-sm",children:a==="buyer"?"Start trading to see your orders here":"Your customer orders will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(r=>e.jsx("div",{className:"p-4 rounded-xl bg-card border border-border hover:border-primary transition-colors","data-testid":`order-card-${r.id}`,children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted flex-shrink-0",children:b(r.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-foreground font-medium text-sm sm:text-base truncate",children:["Order #",r.id.slice(0,8)]}),e.jsx("div",{className:"flex-shrink-0",children:j(r.status)})]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:new Date(r.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"text-base sm:text-lg font-bold text-foreground",children:[Math.floor(parseFloat(r.amount))," account",Math.floor(parseFloat(r.amount))!==1?"s":""]}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:["$",Math.floor(parseFloat(r.fiatAmount))," â€¢ ",e.jsx("span",{className:"hidden sm:inline",children:r.paymentMethod})]})]}),e.jsx(x,{href:`/order/${r.id}`,className:"w-full sm:w-auto",children:e.jsxs(u,{variant:"outline",size:"sm",className:"gap-2 w-full sm:w-auto","data-testid":`button-view-order-${r.id}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"View Details"}),e.jsx("span",{className:"sm:hidden",children:"View"}),e.jsx(p,{className:"h-3 sm:h-4 w-3 sm:w-4"})]})})]})]})},r.id))}),f=s=>!s||s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(m,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No loader orders yet"}),e.jsx("p",{className:"text-muted-foreground/70 text-sm",children:"Your Loaders Zone orders will appear here"})]}):e.jsx("div",{className:"space-y-4",children:s.map(a=>e.jsx("div",{className:"p-4 rounded-xl bg-card border border-border hover:border-primary transition-colors","data-testid":`loader-order-card-${a.id}`,children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10 flex-shrink-0",children:e.jsx(m,{className:"h-4 sm:h-5 w-4 sm:w-5 text-primary"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-foreground font-medium",children:[a.role==="loader"?"Loading to":"Receiving from"," ",a.role==="loader"?a.receiverUsername:a.loaderUsername]}),N(a.status),e.jsx(l,{variant:"outline",className:"text-primary border-primary",children:"Loaders Zone"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[new Date(a.createdAt).toLocaleDateString()," at"," ",new Date(a.createdAt).toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xl font-bold text-foreground",children:["$",parseFloat(a.dealAmount).toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.role==="loader"?"Loader":"Receiver"})]}),e.jsx(x,{href:`/loader-order/${a.id}`,children:e.jsxs(u,{variant:"outline",size:"sm",className:"gap-2","data-testid":`button-view-loader-order-${a.id}`,children:["View Details",e.jsx(p,{className:"h-4 w-4"})]})})]})]})},a.id))});return e.jsx(C,{children:e.jsxs("div",{className:"space-y-4 sm:space-y-8 px-2 sm:px-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground truncate",children:d("orders.myOrders")}),e.jsxs(L,{children:[e.jsx(O,{children:e.jsxs(_,{className:"text-foreground flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),d("orders.orderHistory")]})}),e.jsx(S,{children:g?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>e.jsx(y,{className:"h-24"},s))}):e.jsxs(A,{defaultValue:"buying",children:[e.jsxs(D,{className:"mb-6 flex-wrap",children:[e.jsxs(n,{value:"buying","data-testid":"tab-buying",children:[d("orders.buying")," (",t?.buyerOrders?.length||0,")"]}),e.jsxs(n,{value:"selling","data-testid":"tab-selling",children:[d("orders.selling")," (",t?.vendorOrders?.length||0,")"]}),e.jsxs(n,{value:"loaders","data-testid":"tab-loaders",children:[e.jsx(m,{className:"h-4 w-4 mr-1"}),d("orders.loaders")," (",t?.loaderOrders?.length||0,")"]}),e.jsxs(n,{value:"pending","data-testid":"tab-pending",children:[d("orders.pending")," (",t?.pendingOrders?.length||0,")"]}),e.jsxs(n,{value:"cancelled","data-testid":"tab-cancelled",children:[d("orders.cancelled")," (",t?.cancelledOrders?.length||0,")"]}),e.jsxs(n,{value:"disputed","data-testid":"tab-disputed",children:[d("orders.disputedOrders")," (",t?.disputedOrders?.length||0,")"]})]}),e.jsx(i,{value:"buying",children:c(t?.buyerOrders||[],"buyer")}),e.jsx(i,{value:"selling",children:c(t?.vendorOrders||[],"vendor")}),e.jsx(i,{value:"loaders",children:f(t?.loaderOrders||[])}),e.jsx(i,{value:"pending",children:c(t?.pendingOrders||[],"buyer")}),e.jsx(i,{value:"cancelled",children:c(t?.cancelledOrders||[],"buyer")}),e.jsx(i,{value:"disputed",children:c(t?.disputedOrders||[],"buyer")})]})})]})]})})}export{J as default};
