import{c as i,N as j,j as e,O as q,b as F,r as A,g as O,i as T,a as m,L as c,X as $,Q as B,f as u}from"./index-B6hPo9fH.js";import{B as n}from"./button-DdYfvWb9.js";import{B as b}from"./badge-Dn4EaI7W.js";import{D as _,b as L,c as z,d as N,T as I,e as H,S as K}from"./ThemeToggle-Cd9vwdUm.js";import{u as W}from"./useTranslation-O3_Fa0eH.js";import{S as M}from"./shield-DVigj7cn.js";import{H as U,S as G,B as V,a as Y}from"./shopping-cart-DT7LSJeM.js";import{U as E}from"./index-Dt-oTuiC.js";import{T as Q}from"./triangle-alert-DGpOeCBb.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],S=i("gavel",R);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],X=i("globe",P);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Z=i("log-out",J);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],se=i("menu",ee);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],te=i("settings",ae);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],y=i("wallet",re);function ne(){const{i18n:l}=W(),d=j.find(a=>a.code===l.language)||j[0];return e.jsxs(_,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(n,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white gap-2","data-testid":"language-selector",children:[e.jsx("span",{className:"text-lg",children:d.flag}),e.jsx(X,{className:"h-4 w-4"})]})}),e.jsx(z,{align:"end",className:"bg-gray-900 border-gray-800",children:j.map(a=>e.jsxs(N,{onClick:()=>q(a.code),className:`text-gray-300 focus:text-white focus:bg-gray-800 ${l.language===a.code?"bg-gray-800":""}`,"data-testid":`language-${a.code}`,children:[e.jsx("span",{className:"mr-2",children:a.flag}),a.name]},a.code))})]})}function pe({children:l}){const[d,a]=F(),[x,v]=A.useState(!1),t=O(),r=T(),{data:p}=m({queryKey:["notifications","unread"],queryFn:async()=>(await(await u("/api/notifications/unread/count")).json()).count||0,enabled:r,refetchInterval:3e4}),{data:w}=m({queryKey:["wallet"],queryFn:async()=>(await u("/api/wallet")).json(),enabled:r}),{data:k}=m({queryKey:["userStatus"],queryFn:async()=>(await u("/api/auth/me")).json(),enabled:r,refetchInterval:3e4}),{data:o}=m({queryKey:["orders","pending","count"],queryFn:async()=>(await(await u("/api/orders/pending/count")).json()).count||0,enabled:r,refetchInterval:3e4}),C=()=>{B(),a("/auth")},h=t?.role==="dispute_admin",g=t?.role==="admin",f=h?[{href:"/disputes",icon:S,label:"Disputes"}]:g?[{href:"/wallet",icon:y,label:"Wallet"},{href:"/admin",icon:M,label:"Admin"},{href:"/disputes",icon:S,label:"Disputes"}]:[{href:"/",icon:U,label:"Marketplace"},{href:"/orders",icon:G,label:"Orders"},{href:"/wallet",icon:y,label:"Wallet"}];return!h&&!g&&t?.role==="vendor"&&f.push({href:"/vendor",icon:K,label:"Vendor"}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("nav",{className:"sticky top-0 z-50 border-b border-border bg-background/80 backdrop-blur-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs(c,{href:h?"/disputes":g?"/wallet":"/",className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-primary rounded-lg",children:e.jsx(M,{className:"h-5 w-5 text-primary-foreground"})}),e.jsx("span",{className:"font-bold text-foreground text-lg hidden sm:block",children:"KYC Marketplace"})]}),r&&e.jsx("div",{className:"hidden md:flex items-center gap-1",children:f.map(s=>e.jsx(c,{href:s.href,children:e.jsxs(n,{variant:d===s.href?"secondary":"ghost",size:"sm",className:"gap-2 relative","data-testid":`nav-${s.label.toLowerCase()}`,children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.label,s.label==="Orders"&&o>0&&e.jsx(b,{className:"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center bg-red-500 text-[10px]",children:o>9?"9+":o})]})},s.href))})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[r&&t?.role!=="admin"&&t?.role!=="support"&&t?.role!=="dispute_admin"&&t?.role!=="finance_manager"&&e.jsx(ne,{}),e.jsx(I,{}),r?e.jsxs(e.Fragment,{children:[w&&!h&&e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-card rounded-lg border border-border",children:[e.jsx(y,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-foreground font-medium",children:[parseFloat(w.availableBalance||"0").toFixed(2)," USDT"]})]}),e.jsx(c,{href:"/notifications",children:e.jsxs(n,{variant:"ghost",size:"icon",className:"relative","data-testid":"button-notifications",children:[e.jsx(V,{className:"h-5 w-5"}),p>0&&e.jsx(b,{className:"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center bg-red-500",children:p>9?"9+":p})]})}),e.jsx(c,{href:"/support",children:e.jsx(n,{variant:"ghost",size:"icon",className:"relative","data-testid":"button-support-chat",children:e.jsx(Y,{className:"h-5 w-5"})})}),e.jsxs(_,{children:[e.jsx(L,{asChild:!0,children:e.jsxs(n,{variant:"ghost",className:"gap-2","data-testid":"button-user-menu",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center",children:e.jsx(E,{className:"h-4 w-4 text-primary-foreground"})}),e.jsx("span",{className:"hidden sm:block text-foreground",children:t?.username})]})}),e.jsxs(z,{align:"end",className:"w-48",children:[e.jsxs(N,{onClick:()=>a("/settings"),"data-testid":"menu-settings",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Settings"]}),e.jsx(H,{}),e.jsxs(N,{onClick:C,"data-testid":"menu-logout",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Logout"]})]})]}),e.jsx(n,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>v(!x),children:x?e.jsx($,{className:"h-5 w-5"}):e.jsx(se,{className:"h-5 w-5"})})]}):e.jsx(c,{href:"/auth",children:e.jsx(n,{className:"bg-primary hover:bg-primary/90","data-testid":"button-signin",children:"Sign In"})})]})]}),x&&r&&e.jsx("div",{className:"md:hidden py-4 border-t border-border",children:e.jsx("div",{className:"flex flex-col gap-2",children:f.map(s=>e.jsx(c,{href:s.href,children:e.jsxs(n,{variant:d===s.href?"secondary":"ghost",className:"w-full justify-start gap-2 relative",onClick:()=>v(!1),children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.label,s.label==="Orders"&&o>0&&e.jsx(b,{className:"ml-auto h-5 min-w-5 px-1.5 flex items-center justify-center bg-red-500 text-[10px]",children:o>9?"9+":o})]})},s.href))})})]})}),k?.isFrozen&&e.jsx("div",{className:"bg-destructive/10 border-b border-destructive/20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3 text-destructive",children:[e.jsx(Q,{className:"h-5 w-5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Account Frozen"}),e.jsxs("p",{className:"text-sm text-destructive/90",children:[k.frozenReason||"Your account has been frozen. You cannot make transactions or post ads."," Please contact support for assistance."]})]})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:l})]})}export{S as G,pe as L,te as S,y as W};
